!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=8)}([function(e,t,r){var n;!function(r,i,o,a){"use strict";var s,c,l={URL:r.URL||r.webkitURL||r.mozURL||r.msURL,getUserMedia:(c=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia,c?c.bind(o):c),requestAnimFrame:r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||l.noop,t=t||0,!l.requestAnimFrame)return setTimeout(e,t);var r=(new Date).getTime(),n=new Object,i=l.requestAnimFrame;return n.value=i(function o(){(new Date).getTime()-r>=t?e.call():n.value=i(o)}),n},Blob:r.Blob||r.BlobBuilder||r.WebKitBlobBuilder||r.MozBlobBuilder||r.MSBlobBuilder,btoa:(s=r.btoa||function(e){for(var t="",r=0,n=e.length,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=void 0,a=void 0,s=void 0,c=void 0,l=void 0,d=void 0,u=void 0;r<n;)c=(o=e.charCodeAt(r++))>>2,l=(3&o)<<4|(a=e.charCodeAt(r++))>>4,d=(15&a)<<2|(s=e.charCodeAt(r++))>>6,u=63&s,isNaN(a)?d=u=64:isNaN(s)&&(u=64),t=t+i.charAt(c)+i.charAt(l)+i.charAt(d)+i.charAt(u);return t},s?s.bind(r):l.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return l.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=i.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return r.Worker},blob:function(){return l.Blob},Uint8Array:function(){return r.Uint8Array},Uint32Array:function(){return r.Uint32Array},videoCodecs:function(){var e=i.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(e){}return t}()},noop:function(){},each:function(e,t){var r=void 0,n=void 0;if(l.isArray(e))for(r=-1,n=e.length;++r<n&&!1!==t(r,e[r]););else if(l.isObject(e))for(r in e)if(e.hasOwnProperty(r)&&!1===t(r,e[r]))break},mergeOptions:function(e,t){if(l.isObject(e)&&l.isObject(t)&&Object.keys){var r={};return l.each(e,function(t,n){r[t]=e[t]}),l.each(t,function(n,i){var o=t[n];l.isObject(o)&&e[n]?r[n]=l.mergeOptions(e[n],o):r[n]=o}),r}},setCSSAttr:function(e,t,r){l.isElement(e)&&(l.isString(t)&&l.isString(r)?e.style[t]=r:l.isObject(t)&&l.each(t,function(t,r){e.style[t]=r}))},removeElement:function(e){l.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!l.isString(e))return{};try{var t=new l.Blob([e],{type:"text/javascript"}),r=l.URL.createObjectURL(t);return{objectUrl:r,worker:new Worker(r)}}catch(e){return""+e}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!i.body||!1===e.resizeFont)return e.fontSize;var t=e.text,r=e.gifWidth,n=parseInt(e.fontSize,10),o=parseInt(e.minFontSize,10),s=i.createElement("div"),c=i.createElement("span");for(s.setAttribute("width",r),s.appendChild(c),c.innerHTML=t,c.style.fontSize=n+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",i.body.appendChild(c);c.offsetWidth>r&&n>=o;)c.style.fontSize=--n+"px";return i.body.removeChild(c),n+"px"},webWorkerError:!1},d=Object.freeze({default:l}),u={validate:function(e){e=l.isObject(e)?e:{};var t={};return l.each(u.validators,function(r,n){var i=n.errorCode;if(!e[i]&&!n.condition)return(t=n).error=!0,!1}),delete t.condition,t},isValid:function(e){var t=!0!==u.validate(e).error;return t},validators:[{condition:l.isFunction(l.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:l.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:l.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:l.isFunction(l.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:l.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:l.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:l.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},f=Object.freeze({default:u}),h=function(){},m={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:h,completeCallback:h,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},g=Object.freeze({default:m});function p(){return u.isValid()}function v(){var e,t,r,n,i,o=256,a=499,s=491,c=487,l=503,d=3*l,u=o-1,f=4,h=100,m=16,g=1<<m,p=10,v=10,b=g>>v,w=g<<p-v,y=6,k=(o>>3)*(1<<y),S=30,x=1024,C=256,T=1<<18,E=[],M=[],F=[],U=[];function O(e,t,r,n,a){var s,c,l,d,u,f,h;for((l=t-e)<-1&&(l=-1),(d=t+e)>o&&(d=o),s=t+1,c=t-1,f=1;s<d||c>l;){if(u=U[f++],s<d){h=i[s++];try{h[0]-=u*(h[0]-r)/T|0,h[1]-=u*(h[1]-n)/T|0,h[2]-=u*(h[2]-a)/T|0}catch(e){}}if(c>l){h=i[c--];try{h[0]-=u*(h[0]-r)/T|0,h[1]-=u*(h[1]-n)/T|0,h[2]-=u*(h[2]-a)/T|0}catch(e){}}}}function W(e,t,r,n,o){var a=i[t],s=e/x;a[0]-=s*(a[0]-r)|0,a[1]-=s*(a[1]-n)|0,a[2]-=s*(a[2]-o)|0}function P(e,t,r){var n,a,s,c,l,d,u,h,g,y;for(g=h=~(1<<31),u=d=-1,n=0;n<o;n++)(a=(y=i[n])[0]-e)<0&&(a=-a),(s=y[1]-t)<0&&(s=-s),a+=s,(s=y[2]-r)<0&&(s=-s),(a+=s)<h&&(h=a,d=n),(c=a-(M[n]>>m-f))<g&&(g=c,u=n),l=F[n]>>v,F[n]-=l,M[n]+=l<<p;return F[d]+=b,M[d]-=w,u}(function(e,a,s){var c,l;for(t=e,r=a,n=s,i=new Array(o),c=0;c<o;c++)i[c]=new Array(4),(l=i[c])[0]=l[1]=l[2]=(c<<f+8)/o|0,F[c]=g/o|0,M[c]=0}).apply(this,arguments);var R={map:function(e,t,r){var n,a,s,c,l,d,u;for(l=1e3,u=-1,a=(n=E[t])-1;n<o||a>=0;)n<o&&((s=(d=i[n])[1]-t)>=l?n=o:(n++,s<0&&(s=-s),(c=d[0]-e)<0&&(c=-c),(s+=c)<l&&((c=d[2]-r)<0&&(c=-c),(s+=c)<l&&(l=s,u=d[3])))),a>=0&&((s=t-(d=i[a])[1])>=l?a=-1:(a--,s<0&&(s=-s),(c=d[0]-e)<0&&(c=-c),(s+=c)<l&&((c=d[2]-r)<0&&(c=-c),(s+=c)<l&&(l=s,u=d[3]))));return u}};return R.process=function(){return function(){var i,o,u,m,g,p,v,b,w,T,E,M,F,R;for(r<d&&(n=1),e=30+(n-1)/3,M=t,F=0,R=r,T=(E=r/(3*n))/h|0,b=x,(v=(p=k)>>y)<=1&&(v=0),i=0;i<v;i++)U[i]=b*((v*v-i*i)*C/(v*v));for(w=r<d?3:r%a!=0?3*a:r%s!=0?3*s:r%c!=0?3*c:3*l,i=0;i<E;)if(W(b,o=P(u=(255&M[F+0])<<f,m=(255&M[F+1])<<f,g=(255&M[F+2])<<f),u,m,g),0!==v&&O(v,o,u,m,g),(F+=w)>=R&&(F-=r),i++,0===T&&(T=1),i%T==0)for(b-=b/e,(v=(p-=p/S)>>y)<=1&&(v=0),o=0;o<v;o++)U[o]=b*((v*v-o*o)*C/(v*v))}(),function(){var e;for(e=0;e<o;e++)i[e][0]>>=f,i[e][1]>>=f,i[e][2]>>=f,i[e][3]=e}(),function(){var e,t,r,n,a,s,c,l;for(c=0,l=0,e=0;e<o;e++){for(r=e,n=(a=i[e])[1],t=e+1;t<o;t++)(s=i[t])[1]<n&&(r=t,n=s[1]);if(s=i[r],e!=r&&(t=s[0],s[0]=a[0],a[0]=t,t=s[1],s[1]=a[1],a[1]=t,t=s[2],s[2]=a[2],a[2]=t,t=s[3],s[3]=a[3],a[3]=t),n!=c){for(E[c]=l+e>>1,t=c+1;t<n;t++)E[t]=e;c=n,l=e}}for(E[c]=l+u>>1,t=c+1;t<256;t++)E[t]=u}(),function(){for(var e=[],t=new Array(o),r=0;r<o;r++)t[i[r][3]]=r;for(var n=0,a=0;a<o;a++){var s=t[a];e[n++]=i[s][0],e[n++]=i[s][1],e[n++]=i[s][2]}return e}()},R}function b(){try{this.onmessage=function(t){var r,n=t.data||{};n.gifshot&&(r=e.run(n),postMessage(r))}}catch(e){}var e={dataToRGB:function(e,t,r){for(var n=t*r*4,i=0,o=[];i<n;)o.push(e[i++]),o.push(e[i++]),o.push(e[i++]),i++;return o},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],r=0;r<e.length;r+=3){var n=e[r],i=e[r+1],o=e[r+2];t.push(n<<16|i<<8|o)}return t},processFrameWithQuantizer:function(e,t,r,n){for(var i=this.dataToRGB(e,t,r),o=new v(i,i.length,n),a=o.process(),s=new Uint32Array(this.componentizedPaletteToArray(a)),c=t*r,l=new Uint8Array(c),d=0,u=0;u<c;u++){var f=i[d++],h=i[d++],m=i[d++];l[u]=o.map(f,h,m)}return{pixels:l,palette:s}},run:function(e){var t=e=e||{},r=t.height,n=(t.palette,t.sampleInterval),i=t.width,o=e.data;return this.processFrameWithQuantizer(o,i,r,n)}};return e}function w(e,t,r,n){var i=0,o=(n=n===a?{}:n).loop===a?null:n.loop,s=n.palette===a?null:n.palette;if(t<=0||r<=0||t>65535||r>65535)throw"Width/Height invalid.";e[i++]=71,e[i++]=73,e[i++]=70,e[i++]=56,e[i++]=57,e[i++]=97;if(e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&r,e[i++]=r>>8&255,e[i++]=0|(null!==s?128:0),e[i++]=0,e[i++]=0,null!==o){if(o<0||o>65535)throw"Loop count invalid.";e[i++]=33,e[i++]=255,e[i++]=11,e[i++]=78,e[i++]=69,e[i++]=84,e[i++]=83,e[i++]=67,e[i++]=65,e[i++]=80,e[i++]=69,e[i++]=50,e[i++]=46,e[i++]=48,e[i++]=3,e[i++]=1,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=0}var c=!1;this.addFrame=function(t,r,n,o,l,d){if(!0===c&&(--i,c=!1),d=d===a?{}:d,t<0||r<0||t>65535||r>65535)throw"x/y invalid.";if(n<=0||o<=0||n>65535||o>65535)throw"Width/Height invalid.";if(l.length<n*o)throw"Not enough pixels for the frame size.";var u=!0,f=d.palette;if(f!==a&&null!==f||(u=!1,f=s),f===a||null===f)throw"Must supply either a local or global palette.";for(var h=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(f),m=0;h>>=1;)++m;h=1<<m;var g=d.delay===a?0:d.delay,p=d.disposal===a?0:d.disposal;if(p<0||p>3)throw"Disposal out of range.";var v=!1,b=0;if(d.transparent!==a&&null!==d.transparent&&(v=!0,(b=d.transparent)<0||b>=h))throw"Transparent color index.";if((0!==p||v||0!==g)&&(e[i++]=33,e[i++]=249,e[i++]=4,e[i++]=p<<2|(!0===v?1:0),e[i++]=255&g,e[i++]=g>>8&255,e[i++]=b,e[i++]=0),e[i++]=44,e[i++]=255&t,e[i++]=t>>8&255,e[i++]=255&r,e[i++]=r>>8&255,e[i++]=255&n,e[i++]=n>>8&255,e[i++]=255&o,e[i++]=o>>8&255,e[i++]=!0===u?128|m-1:0,!0===u)for(var w=0,y=f.length;w<y;++w){var k=f[w];e[i++]=k>>16&255,e[i++]=k>>8&255,e[i++]=255&k}i=function(e,t,r,n){e[t++]=r;var i=t++,o=1<<r,s=o-1,c=o+1,l=c+1,d=r+1,u=0,f=0;function h(r){for(;u>=r;)e[t++]=255&f,f>>=8,u-=8,t===i+256&&(e[i]=255,i=t++)}function m(e){f|=e<<u,u+=d,h(8)}var g=n[0]&s,p={};m(o);for(var v=1,b=n.length;v<b;++v){var w=n[v]&s,y=g<<8|w,k=p[y];if(k===a){for(f|=g<<u,u+=d;u>=8;)e[t++]=255&f,f>>=8,u-=8,t===i+256&&(e[i]=255,i=t++);4096===l?(m(o),l=c+1,d=r+1,p={}):(l>=1<<d&&++d,p[y]=l++),g=w}else g=k}m(g),m(c),h(1),i+1===t?e[i]=0:(e[i]=t-i-1,e[t++]=0);return t}(e,i,m<2?2:m,l)},this.end=function(){return!1===c&&(e[i++]=59,c=!0),i}}var y=function(){},k=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=y,this.onRenderProgressCallback=y,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};k.prototype={workerMethods:b(),initializeWebWorkers:function(e){var t,r=v.toString()+"("+b.toString()+"());",n=void 0,o=void 0,a=void 0,s=-1,c="";for(t=e.numWorkers;++s<t;)n=l.createWebWorker(r),l.isObject(n)?(o=n.objectUrl,a=n.worker,this.workers.push({worker:a,objectUrl:o}),this.availableWorkers.push(a)):(c=n,l.webWorkerError=!!n);this.workerError=c,this.canvas=i.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,r="",n=-1;++n<t;)r+=this.byteMap[e[n]];return r},onFrameFinished:function(e){var t=this,r=t.frames,n=!!(t.options.images||[]).length,i=r.every(function(e){return!e.beingProcessed&&e.done});t.numRenderedFrames++,n&&e(t.numRenderedFrames/r.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/r.length),i?t.generatingGIF||t.generateGIF(r,t.onRenderCompleteCallback):l.requestTimeout(function(){t.processNextFrame()},1)},processFrame:function(e){var t=this,r=(this.options,this.options),n=r.progressCallback,i=r.sampleInterval,o=this.frames,s=void 0,c=void 0,l=function(){var e=(arguments.length>0&&arguments[0]!==a?arguments[0]:{}).data;delete s.data,s.pixels=Array.prototype.slice.call(e.pixels),s.palette=Array.prototype.slice.call(e.palette),s.done=!0,s.beingProcessed=!1,t.freeWorker(c),t.onFrameFinished(n)};(s=o[e]).beingProcessed||s.done?this.onFrameFinished():(s.sampleInterval=i,s.beingProcessed=!0,s.gifshot=!0,(c=this.getWorker())?(c.onmessage=l,c.postMessage(s)):l({data:t.workerMethods.run(s)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var r=this.frames[t];if(!r.done&&!r.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var r=[],n={loop:this.repeat},i=this.options,o=i.interval,a=i.frameDuration,s=!!i.images.length,c=i.gifHeight,d=i.gifWidth,u=new w(r,d,c,n),f=this.onRenderProgressCallback,h=s?100*o:0,m=void 0;this.generatingGIF=!0,l.each(e,function(t,r){var n=r.palette;f(.75+.25*r.position*1/e.length);for(var i=0;i<a;i++)u.addFrame(0,0,d,c,r.pixels,{palette:n,delay:h})}),u.end(),f(1),this.frames=[],this.generatingGIF=!1,l.isFunction(t)&&(m=this.bufferToString(r),t("data:image/gif;base64,"+l.btoa(m)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t){t=l.isObject(t)?t:{};var r=this.ctx,n=this.options,i=n.gifWidth,o=n.gifHeight,a=l.getFontSize(t),s=t,c=s.filter,d=s.fontColor,u=s.fontFamily,f=s.fontWeight,h=(s.gifHeight,s.gifWidth,s.text),m=s.textAlign,g=s.textBaseline,p=t.textXCoordinate?t.textXCoordinate:"left"===m?1:"right"===m?i:i/2,v=t.textYCoordinate?t.textYCoordinate:"top"===g?1:"center"===g?o/2:o,b=f+" "+a+" "+u,w=void 0;try{r.filter=c,r.drawImage(e,0,0,i,o),h&&(r.font=b,r.fillStyle=d,r.textAlign=m,r.textBaseline=g,r.fillText(h,p,v)),w=r.getImageData(0,0,i,o),this.addFrameImageData(w)}catch(e){return""+e}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=this.frames,r=e.data;this.frames.push({data:r,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering(function(r){t.destroyWorkers(),l.requestTimeout(function(){e(r)},0)})},destroyWorkers:function(){if(!this.workerError){var e=this.workers;l.each(e,function(e,t){var r=t.worker,n=t.objectUrl;r.terminate(),l.URL.revokeObjectURL(n)})}}};var S=function(){},x={getGIF:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=arguments[1];t=l.isFunction(t)?t:S;var r=i.createElement("canvas"),n=void 0,o=!!e.images.length,s=e.cameraStream,c=e.crop,d=e.filter,u=e.fontColor,f=e.fontFamily,h=e.fontWeight,m=e.keepCameraOn,g=(e.numWorkers,e.progressCallback),p=e.saveRenderingContexts,v=e.savedRenderingContexts,b=e.text,w=e.textAlign,y=e.textBaseline,x=e.videoElement,C=e.videoHeight,T=e.videoWidth,E=e.webcamVideoElement,M=Number(e.gifWidth),F=Number(e.gifHeight),U=Number(e.interval),O=(Number(e.sampleInterval),o?0:1e3*U),W=[],P=v.length?v.length:e.numFrames,R=P,A=new k(e),j=l.getFontSize(e),I=e.textXCoordinate?e.textXCoordinate:"left"===w?1:"right"===w?M:M/2,L=e.textYCoordinate?e.textYCoordinate:"top"===y?1:"center"===y?F/2:F,D=h+" "+j+" "+f,V=c?Math.floor(c.scaledWidth/2):0,H=c?T-c.scaledWidth:0,G=c?Math.floor(c.scaledHeight/2):0,q=c?C-c.scaledHeight:0;P=P!==a?P:10,U=U!==a?U:.1,r.width=M,r.height=F,n=r.getContext("2d"),function e(){v.length||0!==x.currentTime?function e(){var r=R-1;function i(){var i;p&&W.push(n.getImageData(0,0,M,F)),b&&(n.font=D,n.fillStyle=u,n.textAlign=w,n.textBaseline=y,n.fillText(b,I,L)),i=n.getImageData(0,0,M,F),A.addFrameImageData(i),g((P-(R=r))/P),r>0&&l.requestTimeout(e,O),R||A.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:s,videoElement:x,webcamVideoElement:E,savedRenderingContexts:W,keepCameraOn:m})})}v.length?(n.putImageData(v[P-R],0,0),i()):function e(){try{H>T&&(H=T),q>C&&(q=C),V<0&&(V=0),G<0&&(G=0),n.filter=d,n.drawImage(x,V,G,H,q,0,0,M,F),i()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;l.requestTimeout(e,100)}}()}():l.requestTimeout(e,100)}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.videoWidth,r=e.videoHeight,n=e.gifWidth,i=e.gifHeight,o={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>r?(o.width=Math.round(t*(i/r))-n,o.scaledWidth=Math.round(o.width*(r/i))):(o.height=Math.round(r*(n/t))-i,o.scaledHeight=Math.round(o.height*(t/n))),o}},C={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var r=t.cameraStream,n=t.completedCallback,i=t.videoElement;i&&(i.videoWidth>0&&i.videoHeight>0?(i.removeEventListener("loadeddata",C.findVideoSize),n({videoElement:i,cameraStream:r,videoWidth:i.videoWidth,videoHeight:i.videoHeight})):e.attempts<10?(e.attempts+=1,l.requestTimeout(function(){C.findVideoSize(t)},400)):n({videoElement:i,cameraStream:r,videoWidth:C.defaultVideoDimensions.width,videoHeight:C.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){l.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=l.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,r=e.cameraStream,n=e.completedCallback,i=e.streamedCallback,o=e.videoElement;if(l.isFunction(i)&&i(),t){if(l.isString(t))o.src=t,o.innerHTML='<source src="'+t+'" type="video/'+l.getExtension(t)+'" />';else if(t instanceof Blob){try{o.src=l.URL.createObjectURL(t)}catch(e){}o.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(o.mozSrcObject)o.mozSrcObject=r;else if(l.URL)try{o.srcObject=r,o.src=l.URL.createObjectURL(r)}catch(e){o.srcObject=r}o.play(),l.requestTimeout(function e(){e.count=e.count||0,!0===C.loadedData?(C.findVideoSize({videoElement:o,cameraStream:r,completedCallback:n}),C.loadedData=!1):(e.count+=1)>10?C.findVideoSize({videoElement:o,cameraStream:r,completedCallback:n}):e()},0)},startStreaming:function(e){var t=l.isFunction(e.error)?e.error:l.noop,r=l.isFunction(e.streamed)?e.streamed:l.noop,n=l.isFunction(e.completed)?e.completed:l.noop,o=e.crossOrigin,a=e.existingVideo,s=e.lastCameraStream,c=e.options,d=e.webcamVideoElement,u=l.isElement(a)?a:d||i.createElement("video");o&&(u.crossOrigin=c.crossOrigin),u.autoplay=!0,u.loop=!0,u.muted=!0,u.addEventListener("loadeddata",function(e){C.loadedData=!0,c.offset&&(u.currentTime=c.offset)}),a?C.stream({videoElement:u,existingVideo:a,completedCallback:n}):s?C.stream({videoElement:u,cameraStream:s,streamedCallback:r,completedCallback:n}):l.getUserMedia({video:!0},function(e){C.stream({videoElement:u,cameraStream:e,streamedCallback:r,completedCallback:n})},t)},startVideoStreaming:function(e){var t=arguments.length>1&&arguments[1]!==a?arguments[1]:{},r=t.timeout!==a?t.timeout:0,n=t.callback,i=t.webcamVideoElement,o=void 0;r>0&&(o=l.requestTimeout(function(){C.onStreamingTimeout(n)},1e4)),C.startStreaming({error:function(){n({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(o)},completed:function(){var t=arguments.length>0&&arguments[0]!==a?arguments[0]:{},r=t.cameraStream,n=t.videoElement,i=t.videoHeight,o=t.videoWidth;e({cameraStream:r,videoElement:n,videoHeight:i,videoWidth:o})},lastCameraStream:t.lastCameraStream,webcamVideoElement:i,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=e=l.isObject(e)?e:{},r=t.keepCameraOn,n=t.videoElement,i=t.webcamVideoElement,o=e.cameraStream||{},a=o.getTracks&&o.getTracks()||[],s=!!a.length,c=a[0];!r&&s&&l.isFunction(c.stop)&&c.stop(),l.isElement(n)&&!i&&(n.pause(),l.isFunction(l.URL.revokeObjectURL)&&!l.webWorkerError&&n.src&&l.URL.revokeObjectURL(n.src),l.removeElement(n))}};function T(e){e=l.isObject(e)?e:{},C.stopVideoStreaming(e)}function E(e,t){var r=e.options||{},n=r.images,o=r.video,a=Number(r.gifWidth),s=Number(r.gifHeight),c=(Number(r.numFrames),e.cameraStream),d=e.videoElement,u=e.videoWidth,f=e.videoHeight,h=x.getCropDimensions({videoWidth:u,videoHeight:f,gifHeight:s,gifWidth:a}),m=t;r.crop=h,r.videoElement=d,r.videoWidth=u,r.videoHeight=f,r.cameraStream=c,l.isElement(d)&&(d.width=a+h.width,d.height=s+h.height,r.webcamVideoElement||(l.setCSSAttr(d,{position:"fixed",opacity:"0"}),i.body.appendChild(d)),d.play(),x.getGIF(r,function(e){n&&n.length||o&&o.length||T(e),m(e)}))}function M(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var r=l.mergeOptions(m,e)||{},n=e.cameraStream,o=r.images,s=o?o.length:0,c=r.video,d=r.webcamVideoElement;r=l.mergeOptions(r,{gifWidth:Math.floor(r.gifWidth),gifHeight:Math.floor(r.gifHeight)}),s?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,r=e.images,n=e.options,o=e.imagesLength,s=u.validate({getUserMedia:!0,"window.URL":!0}),c=[],d=0,f=void 0,h=void 0;if(s.error)return t(s);function m(){l.each(c,function(e,t){t&&(t.text?h.addFrame(t.img,n,t.text):h.addFrame(t,n))}),function(e,t){e.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})})}(h,t)}h=new k(n),l.each(r,function(e,r){var a=r;r.src&&(a=a.src),l.isElement(a)?(n.crossOrigin&&(a.crossOrigin=n.crossOrigin),c[e]=a,(d+=1)===o&&m()):l.isString(a)&&(f=new Image,n.crossOrigin&&(f.crossOrigin=n.crossOrigin),function(n){r.text&&(n.text=r.text),n.onerror=function(e){var r=void 0;if(0==--o)return(r={}).error="None of the requested images was capable of being retrieved",t(r)},n.onload=function(t){r.text?c[e]={img:n,text:n.text}:c[e]=n,(d+=1)===o&&m(),l.removeElement(n)},n.src=a}(f),l.setCSSAttr(f,{position:"fixed",opacity:"0"}),i.body.appendChild(f))})}({images:o,imagesLength:s,callback:t,options:r}):c?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,r=e.existingVideo,n=e.options,i=u.validate({getUserMedia:!0,"window.URL":!0}),o=void 0,s=void 0;if(i.error)return t(i);if(l.isElement(r)&&r.src){if(s=r.src,o=l.getExtension(s),!l.isSupported.videoCodecs[o])return t(u.messages.videoCodecs)}else l.isArray(r)&&l.each(r,function(e,t){if(o=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),l.isSupported.videoCodecs[o])return r=t,!1});C.startStreaming({completed:function(e){e.options=n||{},E(e,t)},existingVideo:r,crossOrigin:n.crossOrigin,options:n})}({existingVideo:c,callback:t,options:r}):function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,r=e.lastCameraStream,n=e.options,i=e.webcamVideoElement;if(!p())return t(u.validate());n.savedRenderingContexts.length?x.getGIF(n,function(e){t(e)}):C.startVideoStreaming(function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};e.options=n||{},E(e,t)},{lastCameraStream:r,callback:t,webcamVideoElement:i,crossOrigin:n.crossOrigin})}({lastCameraStream:n,callback:t,webcamVideoElement:d,options:r})}}var F={utils:d,error:f,defaultOptions:g,createGIF:M,takeSnapShot:function(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var r=l.mergeOptions(m,e);M(l.mergeOptions(r,{interval:.1,numFrames:1,gifWidth:Math.floor(r.gifWidth),gifHeight:Math.floor(r.gifHeight)}),t)}},stopVideoStreaming:T,isSupported:function(){return u.isValid()},isWebCamGIFSupported:p,isExistingVideoGIFSupported:function(e){var t=!1;if(l.isArray(e)&&e.length){if(l.each(e,function(e,r){l.isSupported.videoCodecs[r]&&(t=!0)}),!t)return!1}else if(l.isString(e)&&e.length&&!l.isSupported.videoCodecs[e])return!1;return u.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return u.isValid({getUserMedia:!0})},VERSION:"0.4.5"};(n=function(){return F}.apply(t,[]))===a||(e.exports=n)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},function(e,t){var r={getUrlParams:function(e){if(!e.match(/:\/\//)||!e.match(/\?/))return{};var t=e.split("?")[1];return t?JSON.parse('{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(e,t){return""===e?t:decodeURIComponent(t)}):{}},getUrlParam:function(e,t){return this.getUrlParams(e)[t]},addUrlParams:function(e){var t=this.getUrlParams(location.href);for(var r in e)t[r]=encodeURIComponent(e[r]);var n="";for(var i in t)n+=n?"&":"?",n+=i+"="+t[i];var o=location.pathname+n;history.pushState(null,null,o)}};e.exports=r},function(e,t){var r={HTTPrequest:function(e,t,r,n){return new Promise(function(i,o){var a=new XMLHttpRequest;if(a.open(t,e),r)for(var s in r)a.setRequestHeader(s,r[s]);a.onload=function(){i(a.response)},a.onerror=function(e){o(Error("Network Error "+e))},n?a.send(n):a.send()})}};e.exports=r},function(module,exports,__webpack_require__){var ajax=__webpack_require__(2),urlUtils=__webpack_require__(1),gifshot=__webpack_require__(0),io={convertToJsonp:function(e){return"load("+JSON.stringify(e)+");"}};io.files={installUploader:function(uploadLink,load){var loader=document.createElement("input");loader.type="file",loader.style.display="none";var handleJson=function(uploadEvent){var reader=new FileReader;reader.onload=function(readerEvent){var b64content=readerEvent.target.result,b64="base64,",b64index=b64content.indexOf(b64)+b64.length;b64content.substr(b64index);var content=atob(b64content.substr(b64index));eval(content)},reader.readAsDataURL(uploadEvent.target.files[0])};loader.addEventListener("change",handleJson,!1),uploadLink.addEventListener("click",loader.click.bind(loader),!1)},dataAsUri:function(e){var t=io.convertToJsonp(e);return"data:application/javascript;base64,"+btoa(t)},installDownloader:function(e,t){e.setAttribute("download","bouboucle.jsonp");var r=function(){e.href=this.dataAsUri(t())}.bind(this);e.addEventListener("click",r,!1)}},io.server={save:function(e,t){var r=io.convertToJsonp(e()),n="/animations/"+(t||Date.now()+".js"),i=encodeURIComponent(r);return ajax.HTTPrequest(n,"POST",{"Content-Type":"application/javascript"},i)},loadDirAsJson:function(e){return ajax.HTTPrequest("/animations/"+e,"GET").catch(console.error.bind(console))},load:function(e,t,r){var n=document.getElementById("the-animation");n&&n.parentNode.removeChild(n),window.load=t;var i=document.createElement("script");return i.setAttribute("src",e),i.setAttribute("id","the-animation"),document.head.appendChild(i),r&&r(e),Promise.resolve("not done but whatever...")}},io.gists={save:function(e){if(0==e().lineData.length)return Promise.resolve(0);var t={description:"stroke looper animation",public:!0,files:{"looper.jsonp":{content:io.convertToJsonp(e())}}},r={"Content-Type":"application/json"};return r[atob("bm9pdGF6aXJvaHR1QQ==").split("").reverse().join("")]=atob("MVUyWW1KalpqQnpOMkkyWXlRVE4zQVRPNEVETTNjVFlraFRZaUZ6TmlabVpoVldaMFF6TXpvelpwUm1iMXQyY2hWbWNrNVdZIGNpc2FC").split("").reverse().join(""),ajax.HTTPrequest("https://api.github.com/gists","POST",r,JSON.stringify(t)).then(JSON.parse).then(function(e){var n=e.id;e.files["looper.jsonp"]&&(n=e.files["looper.jsonp"].raw_url.match(/[^/]+\/raw\/[^/]+/)[0]);var i="http://bouboucle.com?gist="+n;return t.files["description.md"]={content:i},ajax.HTTPrequest("https://api.github.com/gists/"+e.id,"PATCH",r,JSON.stringify(t)),console.log(e),urlUtils.addUrlParams({gist:n}),n})},installSaver:function(e,t){var r=function(){this.save(t)}.bind(this);e.addEventListener("click",r,!1)},makeGistUrl:function(e){return"https://api.github.com/gists/"+e},makeRawGistUrl:function(e){return"https://gist.githubusercontent.com/andreaskundig/"+e+"/looper.jsonp"},load:function(id,load){var request;if(id.includes("raw")){var rawGistUrl=this.makeRawGistUrl(id);console.log(rawGistUrl),request=ajax.HTTPrequest(rawGistUrl,"GET")}else{var gistUrl=this.makeGistUrl(id);request=ajax.HTTPrequest(gistUrl,"GET").then(JSON.parse).then(function(e){if(!(e.files&&"looper.jsonp"in e.files))throw"no files found";return console.log("load gist "+e.html_url),e.files["looper.jsonp"].content})}return request.then(function(content){eval(content),urlUtils.addUrlParams({gist:id})}).catch(console.error.bind(console))},installLoader:function(e,t){var r=function(){var e=prompt("gist to load").trim();e&&(e=urlUtils.getUrlParam(e,"gist")||e,console.log("got param gist ",e),this.load(e,t))}.bind(this);e.addEventListener("click",r,!1)}},io.makeGifRecorder=function(e){var t=0,r=[];return{recordImage:function(){r.push(e.toDataURL("image/png")),t+=r[r.length-1].length},makeGif:function(n,i,o){var a=r.slice(),s=e.width,c=e.width/200/15*t/5e6,l=Math.max(1,c/1),d=Math.min(1,1/Math.sqrt(l));d=o?1:d,r.length=0,s=Math.floor(s*d);var u=Math.floor(s*e.height/e.width);return r.length=0,t=0,new Promise(function(e,t){gifshot.createGIF({interval:n/1e3,images:a,gifWidth:s,gifHeight:u,progressCallback:i},function(r){r.error?(t(r),console.log("gifshot error:",r)):e(r.image)})})}}},module.exports=io},function(e,t){var r,n,i,o=(r={done:[],undone:[]},{installUnRedo:function(e,t){document.getElementById(e).addEventListener("click",n,!1),document.getElementById(t).addEventListener("click",i,!1)},undo:n=function(){if(r.done.length>0){var e=r.done.pop();e.undo(),r.undone.unshift(e)}},redo:i=function(){if(r.undone.length>0){var e=r.undone.shift();e.do(),r.done.push(e)}},do:function(e){e.do(),r.done.push(e),r.undone.length=0,r.done.length>50&&r.done.shift()}});e.exports=o},function(e,t){e.exports=function(e,t,r,n,i,o,a){var s={start:n,last:null,beat:i||2e3,lifetime:r||500,color:e||"black",multiPeriod:isNaN(o)?"auto":parseFloat(o),strokeWidth:t||2,times:[]},c=[],l=new a.Path({visible:!1}),d=function(e){if(s.multiPeriod>0)return i;if(null!==s.last&&"auto"==s.multiPeriod){var t=Math.abs(s.last)+s.lifetime,r=Math.ceil(t/i);return Math.max(1,r)*i}return null!==s.last&&0===s.multiPeriod?Math.abs(s.last)+s.lifetime+1:e+1},u=function(e){var t=e-s.start,r=d(t),n=t%r;return{now:n=n<0?r+n:n,duration:r}};return{calculateTime:u,calculateDuration:d,getMultiPeriod:function(){return s.multiPeriod},segmentsToShow:function(e){return l.segments.filter(function(t,r){var n=s.times[r];return n<=e&&e<n+s.lifetime})},periodSegmentsToShow:function(e){var t=1,r=s.times,n=u(e),i=r.length>0?Math.min(r[r.length-1],r[0]):0,o=0;if((s.multiPeriod>0||null!==s.last)&&(o=Math.floor(i/n.duration)),s.multiPeriod>0&&r.length>0){var a=Math.max(r[r.length-1],r[0])+s.lifetime;t=Math.floor(a/n.duration)-o+1}for(var c=[],l=0;l<t;l++){var d=(o+l)*n.duration||0,f=this.segmentsToShow(n.now+d);c.push(f)}return c},redraw:function(e){this.periodSegmentsToShow(e).forEach(function(e,t){c.length<t+1&&c.push(function(e){return new a.Path({strokeColor:e.color,strokeWidth:e.strokeWidth,strokeJoin:"round",strokeCap:"round"})}(s));var r=c[t];r.removeSegments(),r.addSegments(e),1===r.segments.length&&r.add(r.segments[0])})},pushSegment:function(e,t){var n=t-s.start;n<0&&(n-=r);var i={point:e};s.times.push(n),l.add(i);var o=l.segments.length-2;l.segments[Math.max(0,o)].smooth()},completeCreation:function(e){var t;t=(t=e-s.start)<0?t-s.lifetime:t,s.last=t,l.segments.length>1&&l.smooth({type:"catmull-rom"})},clear:function(){c.forEach(function(e){e.removeSegments()})},exportData:function(){var e=new Object(s);return e.segments=l.segments.map(function(e){return[e.point.x,e.point.y]}),e},importData:function(e){this.clear(),l.removeSegments(),l.addSegments(e.segments),l.segments.forEach(function(e){e.smooth()}),(s=e).start=s.start},getLastUpdateTime:function(){var e=s.times.length;return s.start+s.times[e-1]||0}}}},function(e,t){e.exports=function(){var e,t,r,n,i,o,a,s=function(){i=t=e=r=a=0,n=o=1},c=function(e){return e/n*o};return s(),{reset:s,getTime:function(r){var i=e+(r-t)*n/o;return t=r,e=i,i},hasBeatChanged:function(e){var t=i?Math.floor(e/i):0,n=t!=r;return r=t,n},tapTempo:function(e){return a?(o=c(e-a)/i,a=0,!1):(a=e,!0)},convertFromRealTime:function(e){return e/c(1)},getBeat:function(){return i},setBeat:function(e){i=e},getSpeed:function(e){return n},setSpeed:function(e){n=e}}}},function(e,t,r){var n=r(6),i=r(5),o=r(4),a=r(3),s=function(e){var t,r,c,l,d,u,f,h,m,g,p,v,b,w,y,k,S,x,C,T=n(),E=function(){var e={width:t.width||h.canvas.width/g.view.pixelRatio,height:t.height||h.canvas.height/g.view.pixelRatio,speed:T.getSpeed(),lineData:t.lines.map(function(e){return e.exportData()})};return p&&(e.backgroundColor=p.fillColor.toCSS()),e},M=function(){var e=t;F({width:v,height:b,lines:[]}),e.lines.forEach(function(e){e.clear()})},F=function(e){t=e,A()},U=function(e,r){var n=t;return{do:function(){!function(e,r){M(),t.width=e.width||1e3,t.height=e.height||600,A(r),e.hasOwnProperty("speed")&&T.setSpeed(e.speed),e.hasOwnProperty("backgroundColor")||(e.backgroundColor="#ffffff"),j(e.backgroundColor),e.lineData.forEach(function(e){var r=i(e.color,e.strokeWidth,e.lifetime,R(),e.beat,e.multiPeriod,g);r.importData(e),t.lines.push(r)})}(e,r)},undo:function(){M(),F(n)}}},O=function(e,n){var a;return r=i(c,l,d,e,T.getBeat(),n,g),o.do((a=r,{do:function(){t.lines.push(a)},undo:function(){t.lines.pop(),a.clear()}})),r},W=function(e,t,n){r.pushSegment([e,t],n)},P=function(e){r.completeCreation(e),r=null},R=function(){return T.getTime(Date.now())},A=function(e){e&&(v=e.width,b=e.height);var r=t.width/t.height,n=v/b<r?v:Math.floor(b*r),i=Math.floor(n/r),o=n/t.width;g.activate(),g.view.zoom=o;var a=new h.paper.Point(h.canvas.width/2/o/g.view.pixelRatio,h.canvas.height/2/o/g.view.pixelRatio);g.view.center=a,g.view.viewSize=new h.paper.Size(n,i),p&&j(p.fillColor)},j=function(e){if(g.activate(),e){var t=new g.Path.Rectangle(g.view.bounds);t.fillColor=e,p&&p.replaceWith(t),p=t}else p&&(p.remove(),p=null)},I=function(e){t.lines.forEach(function(t){t.redraw(e)}),g.view.draw()},L=function(){g.activate(),m=!1;var e=function(){var t=T.getTime(Date.now());I(t),T.hasBeatChanged(t)&&f&&f(t),m||requestAnimationFrame(e)};e()},D=function(){m=!0},V=function(e,t){return e*t/function(e,t){if(e<0&&(e=-e),t<0&&(t=-t),t>e){var r=e;e=t,t=r}for(;;){if(0===t)return e;if(0==(e%=t))return t;t%=e}}(e,t)},H=function(){return t.lines.map(function(e){return"auto"===e.getMultiPeriod()?1:e.calculateDuration()}).reduce(V)};return k=(w=e).beat,S=w.multiPeriod,x={width:w.width||1e3,height:w.height||600},C=x.width/x.height,w.ratio&&(C<w.ratio?x.height=x.width/w.ratio:x.width=x.height*w.ratio,console.log(w.width,w.height,x)),h=w.graphics,function(e,n){(t={lines:[]}).width=n.width,t.height=n.height,v=n.width,b=n.height,T.reset(),r=c=l=d=null,u=e||1}(S,x),T.reset(),T.setBeat(k||2e3),(g=new h.paper.PaperScope).setup(h.canvas),(y=new g.Tool).minDistance=3,y.onMouseDown=function(e){O(R(),u),W(e.point.x,e.point.y,R())},y.onMouseDrag=function(e){W(e.point.x,e.point.y,R())},y.onMouseUp=function(){P(R())},j(w.backgroundColor),A(x),g.view.draw(),{start:L,stop:D,exportData:E,now:R,newLine:O,drawPoint:W,completeLine:P,importData:function(e,t){o.do(U(e,t))},clear:function(){var e;o.do((e=t,{do:M,undo:function(){F(e)}}))},setLineColor:function(e){c=e},setStrokeWidth:function(e){l=e},setLifetime:function(e){d=e},setPeriods:function(e){u=e},scale:A,getTime:T.getTime.bind(T),setSpeed:T.setSpeed.bind(T),setBeat:T.setBeat.bind(T),tapTempo:function(){return T.tapTempo(R())},setBeatListener:function(e){f=e},redrawAllLines:I,makeGifRecorder:function(){return a.makeGifRecorder(h.canvas)},findShortestLoop:H,record:function(e){var t=e.progress,r=e.duration||Math.min(6e3,H()),n=e.fullSize,i=e.graphics,o=(n?h.canvas.width:500)/g.view.pixelRatio,a=o/h.canvas.width*h.canvas.height,c=T.getTime(Date.now()),l=T.convertFromRealTime(50);i||(i={canvas:document.getElementById("hidden-canvas"),paper:h.paper});var d={graphics:i,width:o,height:a};p&&(d.backgroundColor=p.fillColor);var u=s(d),f=u.makeGifRecorder();u.importData(E()),D();for(var m=0;m<r;m+=l)u.redrawAllLines(c+m),f.recordImage();return f.makeGif(50,t,n).then(function(e){return L(),e})},makeCircleLineData:function(e,t,r,n){var i=t.x+r.width/2,o=t.y+r.height/2,a=r.width/2,s=2*Math.PI*a/2,c=20*n,l={start:e.start||0,last:e.last||e.beat,beat:e.beat,lifetime:e.lifetime,color:"#000000",multiPeriod:1,strokeWidth:e.strokeWidth};n=n||.05,l.times=[],l.segments=[];for(var d=0;d<s;d+=c){var u=d/a-Math.PI/2;l.segments.push([i+Math.sin(u)*a,o-Math.cos(u)*a]),l.times.push(d/n)}return l},makeSinLineData:function(e,t,r,n){n=n||.05;for(var i=r.width,o=r.height,a=t.x,s=t.y,c=4*Math.sqrt(Math.pow(o,2)+Math.pow(i/4,2)),l=20*n,d={start:e.start||0,last:e.last||e.beat,beat:e.beat,lifetime:e.lifetime,color:"#000000",multiPeriod:1,strokeWidth:e.strokeWidth,times:[],segments:[]},u=0;u<c;u+=l){var f=u/c*Math.PI*4;d.segments.push([a+u/c*i,s+(Math.cos(f-Math.PI)+1)/2*o/2]),d.times.push(u/n)}return d},makeStraightLineData:function(e,t,r,n){var i=r.width,o=r.height,a=Math.sqrt(Math.pow(i,2)+Math.pow(o,2)),s=i/a,c=o/a,l=20*n,d={start:e.start||0,last:e.last||e.beat,beat:e.beat,lifetime:e.lifetime,color:"#000000",multiPeriod:1,strokeWidth:e.strokeWidth};n=n||.025,d.times=[],d.segments=[];for(var u=0;u<a;u+=l)d.segments.push([t.x+u*s,t.y+u*c]),d.times.push(u/n);return d},makeTimingDemo:function(e,t,r){var n=r.width/t[0].length,i=r.height/t.length,o=50,a=(i-50)/2,c={width:n-2*o,height:i-2*a},l={width:r.width,height:r.height,backgroundColor:!1,lineData:[]},d=s({graphics:{canvas:e,paper:h.paper},backgroundColor:!1,width:l.width,height:l.height});return t.forEach(function(e,t){e.forEach(function(e,r){var s=Math.round(r*n)+o,u=Math.round(t*i)+a,f={beat:e.beat,lifetime:e.lifetime,strokeWidth:7},h={x:s,y:u+c.height/2},m=d.makeStraightLineData(f,{x:h.x,y:h.y},{width:c.width,height:0},.05);l.lineData.push(m)})}),d.importData(l),d.start(),d},getLastUpdateTime:function(){var e=t.lines.length;return e?t.lines[e-1].getLastUpdateTime():0},_ps:g}};e.exports=s},function(e,t,r){window.makeLooper=r(7)}]);