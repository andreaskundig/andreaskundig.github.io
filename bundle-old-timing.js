!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(module,exports,__webpack_require__){var ajax=__webpack_require__(8),urlUtils=__webpack_require__(3),gifshot=__webpack_require__(7),io={convertToJsonp:function(e){return"load("+JSON.stringify(e)+");"}};io.files={installUploader:function(uploadLink,load){var loader=document.createElement("input");loader.type="file",loader.style.display="none";var handleJson=function(uploadEvent){var reader=new FileReader;reader.onload=function(readerEvent){var b64content=readerEvent.target.result,b64="base64,",b64index=b64content.indexOf(b64)+b64.length;b64content.substr(b64index);var content=atob(b64content.substr(b64index));eval(content)},reader.readAsDataURL(uploadEvent.target.files[0])};loader.addEventListener("change",handleJson,!1),uploadLink.addEventListener("click",loader.click.bind(loader),!1)},dataAsUri:function(e){var t=io.convertToJsonp(e);return"data:application/javascript;base64,"+btoa(t)},installDownloader:function(e,t){e.setAttribute("download","bouboucle.jsonp");var n=function(){e.href=this.dataAsUri(t())}.bind(this);e.addEventListener("click",n,!1)}},io.server={save:function(e,t){var n=io.convertToJsonp(e()),i="/animations/"+(t||Date.now()+".js"),r=encodeURIComponent(n);return ajax.HTTPrequest(i,"POST",{"Content-Type":"application/javascript"},r)},loadDirAsJson:function(e){return ajax.HTTPrequest("/animations/"+e,"GET").catch(console.error.bind(console))},load:function(e,t,n){var i=document.getElementById("the-animation");i&&i.parentNode.removeChild(i),window.load=t;var r=document.createElement("script");r.setAttribute("src",e),r.setAttribute("id","the-animation"),document.head.appendChild(r),n&&n(e)}},io.gists={save:function(e){if(0==e().lineData.length)return Promise.resolve(0);var t={description:"stroke looper animation",public:!0,files:{"looper.jsonp":{content:io.convertToJsonp(e())}}},n={"Content-Type":"application/json"};return n[atob("bm9pdGF6aXJvaHR1QQ==").split("").reverse().join("")]=atob("MVUyWW1KalpqQnpOMkkyWXlRVE4zQVRPNEVETTNjVFlraFRZaUZ6TmlabVpoVldaMFF6TXpvelpwUm1iMXQyY2hWbWNrNVdZIGNpc2FC").split("").reverse().join(""),ajax.HTTPrequest("https://api.github.com/gists","POST",n,JSON.stringify(t)).then(JSON.parse).then(function(e){return console.log(e),urlUtils.addUrlParams({gist:e.id}),e.id})},installSaver:function(e,t){var n=function(){this.save(t)}.bind(this);e.addEventListener("click",n,!1)},makeGistUrl:function(e){return"https://api.github.com/gists/"+e},load:function(id,load){var gistUrl=this.makeGistUrl(id);return ajax.HTTPrequest(gistUrl,"GET").then(JSON.parse).then(function(data){for(var fileName in console.log("load gist "+data.html_url),data.files){eval(data.files[fileName].content),urlUtils.addUrlParams({gist:id});break}}).catch(console.error.bind(console))},installLoader:function(e,t){var n=function(){var e=prompt("gist to load").trim();e&&(e=urlUtils.getUrlParam(e,"gist")||e,console.log("got param gist ",e),this.load(e,t))}.bind(this);e.addEventListener("click",n,!1)}},io.makeGifRecorder=function(e){var t=0,n=[];return{recordImage:function(){n.push(e.toDataURL("image/png")),t+=n[n.length-1].length},makeGif:function(i,r,o){var a=n.slice(),s=e.width,c=e.width/200/15*t/5e6,l=Math.max(1,c/1),d=Math.min(1,1/Math.sqrt(l));d=o?1:d,n.length=0,s=Math.floor(s*d);var u=Math.floor(s*e.height/e.width);return n.length=0,t=0,new Promise(function(e,t){gifshot.createGIF({interval:i/1e3,images:a,gifWidth:s,gifHeight:u,progressCallback:r},function(n){n.error?(t(n),console.log("gifshot error:",n)):e(n.image)})})}}},module.exports=io},function(e,t){var n,i,r,o=(n={done:[],undone:[]},{installUnRedo:function(e,t){document.getElementById(e).addEventListener("click",i,!1),document.getElementById(t).addEventListener("click",r,!1)},undo:i=function(){if(n.done.length>0){var e=n.done.pop();e.undo(),n.undone.unshift(e)}},redo:r=function(){if(n.undone.length>0){var e=n.undone.shift();e.do(),n.done.push(e)}},do:function(e){e.do(),n.done.push(e),n.undone.length=0,n.done.length>50&&n.done.shift()}});e.exports=o},function(e,t,n){var i=n(5),r=n(4),o=n(1),a=n(0),s=function(e){var t,n,c,l,d,u,f,h,m,p,g,v,b,E,w,C,y,x,F,k=i(),S=function(){var e={width:t.width||h.canvas.width/p.view.pixelRatio,height:t.height||h.canvas.height/p.view.pixelRatio,speed:k.getSpeed(),lineData:t.lines.map(function(e){return e.exportData()})};return g&&(e.backgroundColor=g.fillColor.toCSS()),e},L=function(){var e=t;T({width:v,height:b,lines:[]}),e.lines.forEach(function(e){e.clear()})},T=function(e){t=e,U()},M=function(e,n){var i=t;return{do:function(){!function(e,n){L(),t.width=e.width||1e3,t.height=e.height||600,U(n),e.hasOwnProperty("speed")&&k.setSpeed(e.speed),O(e.backgroundColor),e.lineData.forEach(function(e){var n=r(e.color,e.strokeWidth,e.lifetime,W(),e.beat,e.multiPeriod,p);n.importData(e),t.lines.push(n)})}(e,n)},undo:function(){L(),T(i)}}},A=function(e,i){var a;return n=r(c,l,d,e,k.getBeat(),i,p),o.do((a=n,{do:function(){t.lines.push(a)},undo:function(){t.lines.pop(),a.clear()}})),n},B=function(e,t,i){n.pushSegment([e,t],i)},D=function(e){n.completeCreation(e),n=null},W=function(){return k.getTime(Date.now())},U=function(e){e&&(v=e.width,b=e.height);var n=t.width/t.height,i=v/b<n?v:Math.floor(b*n),r=Math.floor(i/n),o=i/t.width;p.view.zoom=o;var a=new h.paper.Point(h.canvas.width/2/o/p.view.pixelRatio,h.canvas.height/2/o/p.view.pixelRatio);p.view.center=a,p.view.viewSize=new h.paper.Size(i,r),g&&O(g.fillColor)},O=function(e){if(e){var t=new p.Path.Rectangle(p.view.bounds);t.fillColor=e,g&&g.replaceWith(t),g=t}else g&&(g.remove(),g=null)},R=function(e){t.lines.forEach(function(t){t.redraw(e)}),p.view.draw()},j=function(){m=!1;var e=function(){var t=k.getTime(Date.now());R(t),k.hasBeatChanged(t)&&f&&f(t),m||requestAnimationFrame(e)};e()},P=function(){m=!0},H=function(e,t){return e*t/function(e,t){if(e<0&&(e=-e),t<0&&(t=-t),t>e){var n=e;e=t,t=n}for(;;){if(0===t)return e;if(0==(e%=t))return t;t%=e}}(e,t)},I=function(){return t.lines.map(function(e){return"auto"===e.getMultiPeriod()?1:e.calculateDuration()}).reduce(H)};return C=(E=e).beat,y=E.multiPeriod,x={width:E.width||1e3,height:E.height||600},F=x.width/x.height,E.ratio&&(F<E.ratio?x.height=x.width/E.ratio:x.width=x.height*E.ratio,console.log(E.width,E.height,x)),h=E.graphics,function(e,i){(t={lines:[]}).width=i.width,t.height=i.height,v=i.width,b=i.height,k.reset(),n=c=l=d=null,u=e||1}(y,x),k.reset(),k.setBeat(C||2e3),(p=new h.paper.PaperScope).setup(h.canvas),(w=new p.Tool).minDistance=3,w.onMouseDown=function(e){A(W(),u),B(e.point.x,e.point.y,W())},w.onMouseDrag=function(e){B(e.point.x,e.point.y,W())},w.onMouseUp=function(){D(W())},E.backgroundColor&&O(E.backgroundColor),U(x),p.view.draw(),{start:j,stop:P,exportData:S,now:W,newLine:A,drawPoint:B,completeLine:D,importData:function(e,t){o.do(M(e,t))},clear:function(){var e;o.do((e=t,{do:L,undo:function(){T(e)}}))},setLineColor:function(e){c=e},setStrokeWidth:function(e){l=e},setLifetime:function(e){d=e},setPeriods:function(e){u=e},scale:U,getTime:k.getTime.bind(k),setSpeed:k.setSpeed.bind(k),setBeat:k.setBeat.bind(k),tapTempo:function(){return k.tapTempo(W())},setBeatListener:function(e){f=e},redrawAllLines:R,makeGifRecorder:function(){return a.makeGifRecorder(h.canvas)},findShortestLoop:I,record:function(e){var t=e.progress,n=e.duration||Math.min(6e3,I()),i=e.fullSize,r=e.graphics,o=(i?h.canvas.width:500)/p.view.pixelRatio,a=o/h.canvas.width*h.canvas.height,c=k.getTime(Date.now()),l=k.convertFromRealTime(50);r||(r={canvas:document.getElementById("hidden-canvas"),paper:h.paper});var d={graphics:r,width:o,height:a};g&&(d.backgroundColor=g.fillColor);var u=s(d),f=u.makeGifRecorder();u.importData(S()),P();for(var m=0;m<n;m+=l)u.redrawAllLines(c+m),f.recordImage();return f.makeGif(50,t,i).then(function(e){return j(),e})},makeCircleLineData:function(e,t,n,i){var r=t.x+n.width/2,o=t.y+n.height/2,a=n.width/2,s=2*Math.PI*a/2,c=20*i,l={start:e.start||0,last:e.last||e.beat,beat:e.beat,lifetime:e.lifetime,color:"#000000",multiPeriod:1,strokeWidth:e.strokeWidth};i=i||.05,l.times=[],l.segments=[];for(var d=0;d<s;d+=c){var u=d/a-Math.PI/2;l.segments.push([r+Math.sin(u)*a,o-Math.cos(u)*a]),l.times.push(d/i)}return l},makeSinLineData:function(e,t,n,i){i=i||.05;for(var r=n.width,o=n.height,a=t.x,s=t.y,c=4*Math.sqrt(Math.pow(o,2)+Math.pow(r/4,2)),l=20*i,d={start:e.start||0,last:e.last||e.beat,beat:e.beat,lifetime:e.lifetime,color:"#000000",multiPeriod:1,strokeWidth:e.strokeWidth,times:[],segments:[]},u=0;u<c;u+=l){var f=u/c*Math.PI*4;d.segments.push([a+u/c*r,s+(Math.cos(f-Math.PI)+1)/2*o/2]),d.times.push(u/i)}return d},makeStraightLineData:function(e,t,n,i){var r=n.width,o=n.height,a=Math.sqrt(Math.pow(r,2)+Math.pow(o,2)),s=r/a,c=o/a,l=20*i,d={start:e.start||0,last:e.last||e.beat,beat:e.beat,lifetime:e.lifetime,color:"#000000",multiPeriod:1,strokeWidth:e.strokeWidth};i=i||.025,d.times=[],d.segments=[];for(var u=0;u<a;u+=l)d.segments.push([t.x+u*s,t.y+u*c]),d.times.push(u/i);return d},makeTimingDemo:function(e,t,n){var i=n.width/t[0].length,r=n.height/t.length,o=50,a=(r-50)/2,c={width:i-2*o,height:r-2*a},l={width:n.width,height:n.height,lineData:[]},d=s({graphics:{canvas:e,paper:h.paper},noBackground:!0,width:l.width,height:l.height});return t.forEach(function(e,t){e.forEach(function(e,n){var s=Math.round(n*i)+o,u=Math.round(t*r)+a,f={beat:e.beat,lifetime:e.lifetime,strokeWidth:7},h={x:s,y:u+c.height/2},m=d.makeStraightLineData(f,{x:h.x,y:h.y},{width:c.width,height:0},.05);l.lineData.push(m)})}),d.importData(l),d.start(),d},getLastUpdateTime:function(){var e=t.lines.length;return e?t.lines[e-1].getLastUpdateTime():0},_ps:p}};e.exports=s},function(e,t){var n={getUrlParams:function(e){if(!e.match(/:\/\//)||!e.match(/\?/))return{};var t=e.split("?")[1];return t?JSON.parse('{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(e,t){return""===e?t:decodeURIComponent(t)}):{}},getUrlParam:function(e,t){return this.getUrlParams(e)[t]},addUrlParams:function(e){var t=this.getUrlParams(location.href);for(var n in e)t[n]=encodeURIComponent(e[n]);var i="";for(var r in t)i+=i?"&":"?",i+=r+"="+t[r];var o=location.pathname+i;history.pushState(null,null,o)}};e.exports=n},function(e,t){e.exports=function(e,t,n,i,r,o,a){var s={start:i,last:null,beat:r||2e3,lifetime:n||500,color:e||"black",multiPeriod:isNaN(o)?"auto":parseFloat(o),strokeWidth:t||2,times:[]},c=[],l=new a.Path({visible:!1}),d=function(e){if(s.multiPeriod>0)return r;if(null!==s.last&&"auto"==s.multiPeriod){var t=Math.abs(s.last)+s.lifetime,n=Math.ceil(t/r);return Math.max(1,n)*r}return null!==s.last&&0===s.multiPeriod?Math.abs(s.last)+s.lifetime+1:e+1},u=function(e){var t=e-s.start,n=d(t),i=t%n;return{now:i=i<0?n+i:i,duration:n}};return{calculateTime:u,calculateDuration:d,getMultiPeriod:function(){return s.multiPeriod},segmentsToShow:function(e){return l.segments.filter(function(t,n){var i=s.times[n];return i<=e&&e<i+s.lifetime})},periodSegmentsToShow:function(e){var t=1,n=s.times,i=u(e),r=n.length>0?Math.min(n[n.length-1],n[0]):0,o=0;if((s.multiPeriod>0||null!==s.last)&&(o=Math.floor(r/i.duration)),s.multiPeriod>0&&n.length>0){var a=Math.max(n[n.length-1],n[0])+s.lifetime;t=Math.floor(a/i.duration)-o+1}for(var c=[],l=0;l<t;l++){var d=(o+l)*i.duration||0,f=this.segmentsToShow(i.now+d);c.push(f)}return c},redraw:function(e){this.periodSegmentsToShow(e).forEach(function(e,t){c.length<t+1&&c.push(function(e){return new a.Path({strokeColor:e.color,strokeWidth:e.strokeWidth,strokeJoin:"round",strokeCap:"round"})}(s));var n=c[t];n.removeSegments(),n.addSegments(e),1===n.segments.length&&n.add(n.segments[0])})},pushSegment:function(e,t){var i=t-s.start;i<0&&(i-=n);var r={point:e};s.times.push(i),l.add(r);var o=l.segments.length-2;l.segments[Math.max(0,o)].smooth()},completeCreation:function(e){var t;t=(t=e-s.start)<0?t-s.lifetime:t,s.last=t,l.segments.length>1&&l.smooth({type:"catmull-rom"})},clear:function(){c.forEach(function(e){e.removeSegments()})},exportData:function(){var e=new Object(s);return e.segments=l.segments.map(function(e){return[e.point.x,e.point.y]}),e},importData:function(e){this.clear(),l.removeSegments(),l.addSegments(e.segments),l.segments.forEach(function(e){e.smooth()}),(s=e).start=s.start},getLastUpdateTime:function(){var e=s.times.length;return s.start+s.times[e-1]||0}}}},function(e,t){e.exports=function(){var e,t,n,i,r,o,a,s=function(){r=t=e=n=a=0,i=o=1},c=function(e){return e/i*o};return s(),{reset:s,getTime:function(n){var r=e+(n-t)*i/o;return t=n,e=r,r},hasBeatChanged:function(e){var t=r?Math.floor(e/r):0,i=t!=n;return n=t,i},tapTempo:function(e){return a?(o=c(e-a)/r,a=0,!1):(a=e,!0)},convertFromRealTime:function(e){return e/c(1)},getBeat:function(){return r},setBeat:function(e){r=e},getSpeed:function(e){return i},setSpeed:function(e){i=e}}}},function(e,t,n){var i,r,o,a,s,c,l=n(0),d=n(2),u={};i=function(e,t,n,i,r,o,a){a=a||.1;var s,c,l=document.createElement("div");l.className="slider",l.innerHTML=['<input type="range" max="'+t+'" min="'+e+'" step="'+a+'">','<input type="text" value="'+i.get()+'">'].join(""),o&&(l.innerHTML+="<a>&#10008;</a><a>&#10004;</a>",c=l.children[2],s=l.children[3]);var d=l.firstChild,u=l.children[1],f=function(e){return e},h=f;n&&(f=function(e){return Math.floor(Math.pow(Math.E,e))},h=Math.log.bind(Math)),d.value=h(i.get()),u.addEventListener("input",function(e){if(isNaN(e.target.value))u.value=f(d.value);else{var t=parseFloat(e.target.value);d.value=h(t)}o||i.set(u.value)}),d.addEventListener("input",function(e){var t=parseFloat(e.target.value);u.value=f(t),o||i.set(u.value)}),o&&(s.addEventListener("click",function(){i.set(u.value),r.hide()}),c.addEventListener("click",function(){u.value=i.get(),d.value=h(u.value),r.hide()}));return function(e){var t=i.button.getBoundingClientRect();r.replaceContent(l),l.style.left=t.right+"px",l.style.top=t.top-5+"px",u.value=i.get(),d.value=h(u.value),r.show()}},r=function(e,t,n){var i={x:n.width/t[0].length,y:n.height/t.length},r=50,o=(i.y-50)/2,a={width:n.width,height:n.height,lineData:[]},s=d({graphics:e,backgroundColor:"#ffffff",width:a.width,height:a.height});console.log("siez",i),t.forEach(function(e,t){e.forEach(function(e,n){var c=Math.round(n*i.x)+r,l=Math.round(t*i.y)+o,d={beat:e.beat,lifetime:e.lifetime,strokeWidth:7},u={width:i.x-2*r,height:i.y-2*o},f={x:c,y:l},h=s.makeStraightLineData(d,{x:f.x,y:f.y+20},{width:u.width,height:0},.05);a.lineData.push(h)})}),s.importData(a),s.start()},o=function(e,t){var n=document.createElement("a");return n.className="looper-control-button",n.innerHTML=t,e.appendChild(n),n},a=function(e,t,n){return'<i class="'+["fa",t?"fa-fw":"",n||"fa-lg",e].join(" ")+'" aria-hidden="true"></i>'},s=function(e,t,n,i){var r,s=o(t,a("fa-video-camera",1)),c=document.createElement("div"),l=["left:"+(window.innerWidth/4-100)+"px;","top: "+(window.innerHeight/4-60)+"px;","background-color: #E0E0E0; position: absolute;","text-align:right; padding: 10px"].join(""),d=document.createElement("div"),u=document.createElement("div"),f=0;c.style.cssText=l,d.style.fontSize="600%",d.style.width="500px",d.style.backgroundColor="darkGrey",u.style.cssText=["background-color: darkcyan;","height: 10px"].join(""),d.appendChild(u);var h=function(e){var t=Math.abs(500*(.1+.9*e));u.style.width=t+"px"},m=function(t){console.log("start recording for",t),s.style.color="black",u.style.width=Math.abs(50)+"px",c.innerHTML="",c.appendChild(d),e.replaceContent(c),e.show(),new Promise(function(e,t){requestAnimationFrame(e)}).then(function(){return n({progress:h,duration:t})}).then(function(e){console.log("should open image");var t=document.createElement("a"),n=document.createElement("div"),i=document.createElement("img");t.download="bouboucle.gif",t.href=e,t.className="looper-control-button",t.innerHTML=a("fa-download"),i.src=e,i.style.width="500px",n.style.fontSize="24px",c.innerHTML="",c.appendChild(i),n.appendChild(t),c.appendChild(n)},function(e){console.error(e.error,e)}).then(function(){f=0})};s.addEventListener("click",function(){try{if(f){var e=Date.now()-f;clearTimeout(r),m(e)}else{s.style.color="red",f=Date.now();var t=Math.min(6e3,i());r=setTimeout(function(){m(t)},t)}}catch(e){console.error(e)}},!1)},c=function(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)},u.install=function(e){var t,n=function(){var e=document.createElement("div");e.style.cssText="z-index:1; display:none; position:fixed",e.style.cssText+="top:0; left:0; width:100%; height:100%;",document.body.insertBefore(e,document.body.firstChild);var t=function(t){t&&t.target!==e||(e.style.display="none")};return e.addEventListener("click",t),{replaceContent:function(t){for(;e.hasChildNodes();)e.removeChild(e.lastChild);e.appendChild(t)},show:function(){e.style.display=""},makeShowForButton:function(e,t){var n=this;return function(){n.replaceContent(t);var i=e.getBoundingClientRect();t.style.left=i.right+"px",t.style.top=i.top-5+"px",n.show()}},hide:t}}();!function(e){var t=document.createElement("style");t.innerHTML=[".line-control-button {","  cursor: pointer;","  width: "+e+"px;","  height: "+e+"px;","  margin: 5px;}"].join(""),document.getElementsByTagName("head")[0].appendChild(t)}(35),(t=document.createElement("style")).innerHTML=[".looper-control-button{","font-size: 18px;","padding: 9px 12px;","background-color: #E0E0E0; ","color: black;","text-decoration:none;","cursor: pointer}",".looper-control-button:active {background-color: #A0A0A0; }"].join(""),document.getElementsByTagName("head")[0].appendChild(t),function(e){var t=document.createElement("style");t.innerHTML=[".slider {","  height:"+(e+10)+"px; background-color:#E0E0E0; ","  display: flex; align-items: stretch; position:absolute; }",".slider > input[type=range] { height: 100%;}",".slider > input[type=text] {"," text-align:right; width: 22px; padding: 5px; margin: 5px;}",".slider > a {","  vertical-align: middle; line-height: "+(e+10)+"px;","  padding: 0 5px;}"].join(""),document.getElementsByTagName("head")[0].appendChild(t)}(35);var d,u,f,h,m,p,g,v,b,E=e.lineControl,w=document.getElementById(E.id),C=function(){var e=["00","77","aa","ff"],t=[];return e.forEach(function(n){e.forEach(function(i){e.forEach(function(e){t.push("#"+n+i+e)})})}),t}(),y=([function(e,t,n,i,r){var o=document.createElement("div"),a={button:o,color:n},s=document.createElement("div");o.appendChild(s),s.style.cssText=["width:",r,"px; height:",r,"px;"," background-color:",a.color].join(""),s.className="line-control-button";var c=document.createElement("div"),l="background-color:#E0E0E0; width:"+16*(r+4)+"px;";l+="padding:3px; position:absolute",c.style.cssText=l;var d="float:left; margin:2px;";return d+="width:"+r+"px; height:"+r+"px",i.forEach(function(n){var i=document.createElement("div");i.style.cssText=d,i.style.backgroundColor=n,i.addEventListener("click",function(){t&&(t(n),s.style.backgroundColor=n,a.color=n),e.hide()}),c.appendChild(i)}),t(n),o.addEventListener("click",e.makeShowForButton(o,c)),a.button}(n,E.colorSetter,C[0],C,35),function(e,t,n,r){var o=document.createElement("div");o.innerHTML=['<div style="width:'+r+"px; height:"+r+"px;"," border-radius:50%; background-color: black; color:white;"," text-align:center; vertical-align:middle;"," line-height:"+(r-3)+'px"',' class="line-control-button">','  <span style="font: 14px arial,sans-serif;">',n+"</span>","</div>"].join("");var a=o.lastChild.lastChild,s=n,c={button:o,get:function(){return s},set:function(e){s=e,a.innerHTML=e,t&&t(e)}},l=i(0,6.5,!0,c,e,!1);return t(n),o.addEventListener("click",l),c.button}(n,E.strokeWidthSetter,5,35),function(e,t,n,r){var o=document.createElement("div");o.innerHTML=['<div style="width:'+r+"px; height:"+r+"px;"," background-color: white; font: 14px arial,sans-serif;"," text-align: center; line-height:"+r+'px"',' class="line-control-button">','  <span style="">',n+"</span>s","</div>"].join(""),window.b=o;var a=o.lastChild.children[0],s=n,c={button:o,get:function(){return s},set:function(e){s=Math.round(10*e)/10,a.innerHTML=s,t&&t(s)}},l=i(.1,5,!1,c,e,!1);return t(n),o.addEventListener("click",l),c.button}(n,E.lifeTimeSetter,.5,35),function(e,t,n,r){var o=document.createElement("div");o.innerHTML=['<div style="width:'+r+"px; height:"+r+"px;"," text-align:center; vertical-align:middle;"," line-height:"+(r-3)+'px"',' class="line-control-button fa-stack">',a("fa-heart fa-stack-2x",!1,"fa-2x"),' <span class="fa-stack-1x" style="color:white">',n,"</span>","</div>"].join("");var s=o.firstChild.lastChild,c=n,l={button:o,get:function(){return c},set:function(e){c=e,s.innerHTML=c,t&&t(c)}},d=i(.5,5,!1,l,e,!1,.5);return t(n),o.addEventListener("click",d),l.button}(n,E.beatSetter,2,35),function(e,t,n){if(!t)return null;var i=document.createElement("div"),o={button:i,timing:"1"},s=[.05,.25,.5,1,2],c=[6,3,2,1,.5].map(function(e){return s.map(function(t){return{lifetime:1e3*t,beat:1e3*e}})});i.innerHTML=['<div style="width:',n,"px; height:",n,"px;"," text-align:center; vertical-align:middle;"," line-height:",n-3,'px"',' class="line-control-button fa-stack">',a("fa-spinner fa-stack-2x",!1,"fa-2x"),' <span class="fa-stack-1x" >',o.timing,"</span>","</div>"].join(""),i.firstChild.lastChild;var l=document.createElement("div"),d={width:window.innerWidth-100,height:350},u=["background-color:#E0E0E0; width:",d.width+2,"px; height:",d.height+2,"px;"].join("");u+="padding:3px; position:absolute",l.style.cssText=u,l.innerHTML='<div id="timing-div"><canvas></canvas></div>';var f={canvas:l.firstChild.firstChild,paper:paper};return r(f,c,d),t(c[o.timing]),i.addEventListener("click",e.makeShowForButton(i,l)),o.button}(n,E.timingSetter,35),function(e,t,n,i){var r=document.createElement("div");r.innerHTML=['<div style="width:'+i+"px; height:"+i+"px;"," text-align:center; vertical-align:middle;"," line-height:"+(i-3)+'px"',' class="line-control-button">',"</div>"].join("");var o=document.createElement("div"),s=["background-color:#E0E0E0;","padding:3px; position:absolute"].join("");o.style.cssText=s;var c=["float:left; margin:2px;","min-width:"+i+"px; height:"+i+"px;","cursor: pointer; text-align: center"].join(""),l=[1,"auto",0];["fa-ellipsis-h","fa-long-arrow-right","fa-bolt"].forEach(function(t,n){var i=a(t,!1,"fa-2x");r.firstChild.insertAdjacentHTML("beforeend",i);var s=['<div style="',c,'">',a(t,!0,"fa-2x"),"</div>"].join("");o.insertAdjacentHTML("beforeend",s),o.lastChild.addEventListener("click",function(){d(n),e.hide()})});var d=function(e){for(var n=0;n<r.firstChild.children.length;n++)r.firstChild.children[n].style.display=e==n?"block":"none",o.children[n].style.display=e!=n?"block":"none",t(l[e])};return d(l.indexOf(n)),r.addEventListener("click",e.makeShowForButton(r,o)),r}(n,E.periodsSetter,1,35)].forEach(function(e){e&&w.appendChild(e)}),e.looperControl),x=document.getElementById(y.id);o(x,a("fa-times",1)).addEventListener("click",y.clear,!1),o(x,a("fa-reply",1)).addEventListener("click",y.undo,!1),o(x,a("fa-share",1)).addEventListener("click",y.redo,!1),d=x,u=y.setSpeed,f=1,m=o(d,a("fa-backward",1)),p=o(d,a("fa-pause",1)),g=o(d,a("fa-forward",1)),b=function(e){var t,n=0===h;n=n||Math.sign(h)==Math.sign(e),t=Math.abs(h)<=.125?.125*e:n?h:-.5*h,v(h+t)},(v=function(e){h=e,p.innerHTML=a(h?"fa-pause":"fa-play",1),console.log("speed",h),u(h)})(f),p.addEventListener("click",function(){v(h?0:1)},!1),m.addEventListener("click",function(){b(-1)},!1),g.addEventListener("click",function(){b(1)},!1),function(e,t,n){var i=o(e,a("fa-heart",1)),r=!1;i.addEventListener("click",function(){r=t(),i.style.color=r?"white":"black"},!1),n(function(e){if(!r){var t="grey"!=i.style.color?"grey":"black";i.style.color=t}})}(x,y.tapTempo,y.setBeatListener),function(e,t,n,i){var r=o(t,a("fa-file",1)),s=document.createElement("div");s.style.cssText="position: absolute; display: flex; flex-flow: column";var d=function(t){n(t),e.hide()},u=function(){return e.hide(),i()},f=o(s,"upload file");l.files.installUploader(f,d);var h=o(s,"download file");l.files.installDownloader(h,u);var m=o(s,"save gist");l.gists.installSaver(m,u);var p=o(s,"load gist");l.gists.installLoader(p,d),r.addEventListener("click",function(){e.replaceContent(s);var t=r.getBoundingClientRect();s.style.left=t.left+"px",s.style.bottom=c()-t.top+"px",e.show()})}(n,x,y.importData,y.exportData),s(n,x,y.record,y.findShortestLoop)},e.exports=u},function(e,t,n){var i;!function(n,r,o,a){"use strict";var s,c,l={URL:n.URL||n.webkitURL||n.mozURL||n.msURL,getUserMedia:(c=o.getUserMedia||o.webkitGetUserMedia||o.mozGetUserMedia||o.msGetUserMedia,c?c.bind(o):c),requestAnimFrame:n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame,requestTimeout:function(e,t){if(e=e||l.noop,t=t||0,!l.requestAnimFrame)return setTimeout(e,t);var n=(new Date).getTime(),i=new Object,r=l.requestAnimFrame;return i.value=r(function o(){(new Date).getTime()-n>=t?e.call():i.value=r(o)}),i},Blob:n.Blob||n.BlobBuilder||n.WebKitBlobBuilder||n.MozBlobBuilder||n.MSBlobBuilder,btoa:(s=n.btoa||function(e){for(var t="",n=0,i=e.length,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=void 0,a=void 0,s=void 0,c=void 0,l=void 0,d=void 0,u=void 0;n<i;)c=(o=e.charCodeAt(n++))>>2,l=(3&o)<<4|(a=e.charCodeAt(n++))>>4,d=(15&a)<<2|(s=e.charCodeAt(n++))>>6,u=63&s,isNaN(a)?d=u=64:isNaN(s)&&(u=64),t=t+r.charAt(c)+r.charAt(l)+r.charAt(d)+r.charAt(u);return t},s?s.bind(n):l.noop),isObject:function(e){return e&&"[object Object]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){return l.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&"function"==typeof e},isElement:function(e){return e&&1===e.nodeType},isString:function(e){return"string"==typeof e||"[object String]"===Object.prototype.toString.call(e)},isSupported:{canvas:function(){var e=r.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return n.Worker},blob:function(){return l.Blob},Uint8Array:function(){return n.Uint8Array},Uint32Array:function(){return n.Uint32Array},videoCodecs:function(){var e=r.createElement("video"),t={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{e&&e.canPlayType&&(t.mp4=""!==e.canPlayType('video/mp4; codecs="mp4v.20.8"'),t.h264=""!==(e.canPlayType('video/mp4; codecs="avc1.42E01E"')||e.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"')),t.ogv=""!==e.canPlayType('video/ogg; codecs="theora"'),t.ogg=""!==e.canPlayType('video/ogg; codecs="theora"'),t.webm=-1!==e.canPlayType('video/webm; codecs="vp8, vorbis"'))}catch(e){}return t}()},noop:function(){},each:function(e,t){var n=void 0,i=void 0;if(l.isArray(e))for(n=-1,i=e.length;++n<i&&!1!==t(n,e[n]););else if(l.isObject(e))for(n in e)if(e.hasOwnProperty(n)&&!1===t(n,e[n]))break},mergeOptions:function(e,t){if(l.isObject(e)&&l.isObject(t)&&Object.keys){var n={};return l.each(e,function(t,i){n[t]=e[t]}),l.each(t,function(i,r){var o=t[i];l.isObject(o)&&e[i]?n[i]=l.mergeOptions(e[i],o):n[i]=o}),n}},setCSSAttr:function(e,t,n){l.isElement(e)&&(l.isString(t)&&l.isString(n)?e.style[t]=n:l.isObject(t)&&l.each(t,function(t,n){e.style[t]=n}))},removeElement:function(e){l.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!l.isString(e))return{};try{var t=new l.Blob([e],{type:"text/javascript"}),n=l.URL.createObjectURL(t);return{objectUrl:n,worker:new Worker(n)}}catch(e){return""+e}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};if(!r.body||!1===e.resizeFont)return e.fontSize;var t=e.text,n=e.gifWidth,i=parseInt(e.fontSize,10),o=parseInt(e.minFontSize,10),s=r.createElement("div"),c=r.createElement("span");for(s.setAttribute("width",n),s.appendChild(c),c.innerHTML=t,c.style.fontSize=i+"px",c.style.textIndent="-9999px",c.style.visibility="hidden",r.body.appendChild(c);c.offsetWidth>n&&i>=o;)c.style.fontSize=--i+"px";return r.body.removeChild(c),i+"px"},webWorkerError:!1},d=Object.freeze({default:l}),u={validate:function(e){e=l.isObject(e)?e:{};var t={};return l.each(u.validators,function(n,i){var r=i.errorCode;if(!e[r]&&!i.condition)return(t=i).error=!0,!1}),delete t.condition,t},isValid:function(e){var t=!0!==u.validate(e).error;return t},validators:[{condition:l.isFunction(l.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:l.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:l.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:l.isFunction(l.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:l.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:l.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:l.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},f=Object.freeze({default:u}),h=function(){},m={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:h,completeCallback:h,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},p=Object.freeze({default:m});function g(){return u.isValid()}function v(){var e,t,n,i,r,o=256,a=499,s=491,c=487,l=503,d=3*l,u=o-1,f=4,h=100,m=16,p=1<<m,g=10,v=10,b=p>>v,E=p<<g-v,w=6,C=(o>>3)*(1<<w),y=30,x=1024,F=256,k=1<<18,S=[],L=[],T=[],M=[];function A(e,t,n,i,a){var s,c,l,d,u,f,h;for((l=t-e)<-1&&(l=-1),(d=t+e)>o&&(d=o),s=t+1,c=t-1,f=1;s<d||c>l;){if(u=M[f++],s<d){h=r[s++];try{h[0]-=u*(h[0]-n)/k|0,h[1]-=u*(h[1]-i)/k|0,h[2]-=u*(h[2]-a)/k|0}catch(e){}}if(c>l){h=r[c--];try{h[0]-=u*(h[0]-n)/k|0,h[1]-=u*(h[1]-i)/k|0,h[2]-=u*(h[2]-a)/k|0}catch(e){}}}}function B(e,t,n,i,o){var a=r[t],s=e/x;a[0]-=s*(a[0]-n)|0,a[1]-=s*(a[1]-i)|0,a[2]-=s*(a[2]-o)|0}function D(e,t,n){var i,a,s,c,l,d,u,h,p,w;for(p=h=~(1<<31),u=d=-1,i=0;i<o;i++)(a=(w=r[i])[0]-e)<0&&(a=-a),(s=w[1]-t)<0&&(s=-s),a+=s,(s=w[2]-n)<0&&(s=-s),(a+=s)<h&&(h=a,d=i),(c=a-(L[i]>>m-f))<p&&(p=c,u=i),l=T[i]>>v,T[i]-=l,L[i]+=l<<g;return T[d]+=b,L[d]-=E,u}(function(e,a,s){var c,l;for(t=e,n=a,i=s,r=new Array(o),c=0;c<o;c++)r[c]=new Array(4),(l=r[c])[0]=l[1]=l[2]=(c<<f+8)/o|0,T[c]=p/o|0,L[c]=0}).apply(this,arguments);var W={map:function(e,t,n){var i,a,s,c,l,d,u;for(l=1e3,u=-1,a=(i=S[t])-1;i<o||a>=0;)i<o&&((s=(d=r[i])[1]-t)>=l?i=o:(i++,s<0&&(s=-s),(c=d[0]-e)<0&&(c=-c),(s+=c)<l&&((c=d[2]-n)<0&&(c=-c),(s+=c)<l&&(l=s,u=d[3])))),a>=0&&((s=t-(d=r[a])[1])>=l?a=-1:(a--,s<0&&(s=-s),(c=d[0]-e)<0&&(c=-c),(s+=c)<l&&((c=d[2]-n)<0&&(c=-c),(s+=c)<l&&(l=s,u=d[3]))));return u}};return W.process=function(){return function(){var r,o,u,m,p,g,v,b,E,k,S,L,T,W;for(n<d&&(i=1),e=30+(i-1)/3,L=t,T=0,W=n,k=(S=n/(3*i))/h|0,b=x,(v=(g=C)>>w)<=1&&(v=0),r=0;r<v;r++)M[r]=b*((v*v-r*r)*F/(v*v));for(E=n<d?3:n%a!=0?3*a:n%s!=0?3*s:n%c!=0?3*c:3*l,r=0;r<S;)if(B(b,o=D(u=(255&L[T+0])<<f,m=(255&L[T+1])<<f,p=(255&L[T+2])<<f),u,m,p),0!==v&&A(v,o,u,m,p),(T+=E)>=W&&(T-=n),r++,0===k&&(k=1),r%k==0)for(b-=b/e,(v=(g-=g/y)>>w)<=1&&(v=0),o=0;o<v;o++)M[o]=b*((v*v-o*o)*F/(v*v))}(),function(){var e;for(e=0;e<o;e++)r[e][0]>>=f,r[e][1]>>=f,r[e][2]>>=f,r[e][3]=e}(),function(){var e,t,n,i,a,s,c,l;for(c=0,l=0,e=0;e<o;e++){for(n=e,i=(a=r[e])[1],t=e+1;t<o;t++)(s=r[t])[1]<i&&(n=t,i=s[1]);if(s=r[n],e!=n&&(t=s[0],s[0]=a[0],a[0]=t,t=s[1],s[1]=a[1],a[1]=t,t=s[2],s[2]=a[2],a[2]=t,t=s[3],s[3]=a[3],a[3]=t),i!=c){for(S[c]=l+e>>1,t=c+1;t<i;t++)S[t]=e;c=i,l=e}}for(S[c]=l+u>>1,t=c+1;t<256;t++)S[t]=u}(),function(){for(var e=[],t=new Array(o),n=0;n<o;n++)t[r[n][3]]=n;for(var i=0,a=0;a<o;a++){var s=t[a];e[i++]=r[s][0],e[i++]=r[s][1],e[i++]=r[s][2]}return e}()},W}function b(){try{this.onmessage=function(t){var n,i=t.data||{};i.gifshot&&(n=e.run(i),postMessage(n))}}catch(e){}var e={dataToRGB:function(e,t,n){for(var i=t*n*4,r=0,o=[];r<i;)o.push(e[r++]),o.push(e[r++]),o.push(e[r++]),r++;return o},componentizedPaletteToArray:function(e){e=e||[];for(var t=[],n=0;n<e.length;n+=3){var i=e[n],r=e[n+1],o=e[n+2];t.push(i<<16|r<<8|o)}return t},processFrameWithQuantizer:function(e,t,n,i){for(var r=this.dataToRGB(e,t,n),o=new v(r,r.length,i),a=o.process(),s=new Uint32Array(this.componentizedPaletteToArray(a)),c=t*n,l=new Uint8Array(c),d=0,u=0;u<c;u++){var f=r[d++],h=r[d++],m=r[d++];l[u]=o.map(f,h,m)}return{pixels:l,palette:s}},run:function(e){var t=e=e||{},n=t.height,i=(t.palette,t.sampleInterval),r=t.width,o=e.data;return this.processFrameWithQuantizer(o,r,n,i)}};return e}function E(e,t,n,i){var r=0,o=(i=i===a?{}:i).loop===a?null:i.loop,s=i.palette===a?null:i.palette;if(t<=0||n<=0||t>65535||n>65535)throw"Width/Height invalid.";e[r++]=71,e[r++]=73,e[r++]=70,e[r++]=56,e[r++]=57,e[r++]=97;if(e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=0|(null!==s?128:0),e[r++]=0,e[r++]=0,null!==o){if(o<0||o>65535)throw"Loop count invalid.";e[r++]=33,e[r++]=255,e[r++]=11,e[r++]=78,e[r++]=69,e[r++]=84,e[r++]=83,e[r++]=67,e[r++]=65,e[r++]=80,e[r++]=69,e[r++]=50,e[r++]=46,e[r++]=48,e[r++]=3,e[r++]=1,e[r++]=255&o,e[r++]=o>>8&255,e[r++]=0}var c=!1;this.addFrame=function(t,n,i,o,l,d){if(!0===c&&(--r,c=!1),d=d===a?{}:d,t<0||n<0||t>65535||n>65535)throw"x/y invalid.";if(i<=0||o<=0||i>65535||o>65535)throw"Width/Height invalid.";if(l.length<i*o)throw"Not enough pixels for the frame size.";var u=!0,f=d.palette;if(f!==a&&null!==f||(u=!1,f=s),f===a||null===f)throw"Must supply either a local or global palette.";for(var h=function(e){var t=e.length;if(t<2||t>256||t&t-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return t}(f),m=0;h>>=1;)++m;h=1<<m;var p=d.delay===a?0:d.delay,g=d.disposal===a?0:d.disposal;if(g<0||g>3)throw"Disposal out of range.";var v=!1,b=0;if(d.transparent!==a&&null!==d.transparent&&(v=!0,(b=d.transparent)<0||b>=h))throw"Transparent color index.";if((0!==g||v||0!==p)&&(e[r++]=33,e[r++]=249,e[r++]=4,e[r++]=g<<2|(!0===v?1:0),e[r++]=255&p,e[r++]=p>>8&255,e[r++]=b,e[r++]=0),e[r++]=44,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=255&o,e[r++]=o>>8&255,e[r++]=!0===u?128|m-1:0,!0===u)for(var E=0,w=f.length;E<w;++E){var C=f[E];e[r++]=C>>16&255,e[r++]=C>>8&255,e[r++]=255&C}r=function(e,t,n,i){e[t++]=n;var r=t++,o=1<<n,s=o-1,c=o+1,l=c+1,d=n+1,u=0,f=0;function h(n){for(;u>=n;)e[t++]=255&f,f>>=8,u-=8,t===r+256&&(e[r]=255,r=t++)}function m(e){f|=e<<u,u+=d,h(8)}var p=i[0]&s,g={};m(o);for(var v=1,b=i.length;v<b;++v){var E=i[v]&s,w=p<<8|E,C=g[w];if(C===a){for(f|=p<<u,u+=d;u>=8;)e[t++]=255&f,f>>=8,u-=8,t===r+256&&(e[r]=255,r=t++);4096===l?(m(o),l=c+1,d=n+1,g={}):(l>=1<<d&&++d,g[w]=l++),p=E}else p=C}m(p),m(c),h(1),r+1===t?e[r]=0:(e[r]=t-r-1,e[t++]=0);return t}(e,r,m<2?2:m,l)},this.end=function(){return!1===c&&(e[r++]=59,c=!0),r}}var w=function(){},C=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=w,this.onRenderProgressCallback=w,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};C.prototype={workerMethods:b(),initializeWebWorkers:function(e){var t,n=v.toString()+"("+b.toString()+"());",i=void 0,o=void 0,a=void 0,s=-1,c="";for(t=e.numWorkers;++s<t;)i=l.createWebWorker(n),l.isObject(i)?(o=i.objectUrl,a=i.worker,this.workers.push({worker:a,objectUrl:o}),this.availableWorkers.push(a)):(c=i,l.webWorkerError=!!i);this.workerError=c,this.canvas=r.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var e=[],t=0;t<256;t++)e[t]=String.fromCharCode(t);return e}(),bufferToString:function(e){for(var t=e.length,n="",i=-1;++i<t;)n+=this.byteMap[e[i]];return n},onFrameFinished:function(e){var t=this,n=t.frames,i=!!(t.options.images||[]).length,r=n.every(function(e){return!e.beingProcessed&&e.done});t.numRenderedFrames++,i&&e(t.numRenderedFrames/n.length),t.onRenderProgressCallback(.75*t.numRenderedFrames/n.length),r?t.generatingGIF||t.generateGIF(n,t.onRenderCompleteCallback):l.requestTimeout(function(){t.processNextFrame()},1)},processFrame:function(e){var t=this,n=(this.options,this.options),i=n.progressCallback,r=n.sampleInterval,o=this.frames,s=void 0,c=void 0,l=function(){var e=(arguments.length>0&&arguments[0]!==a?arguments[0]:{}).data;delete s.data,s.pixels=Array.prototype.slice.call(e.pixels),s.palette=Array.prototype.slice.call(e.palette),s.done=!0,s.beingProcessed=!1,t.freeWorker(c),t.onFrameFinished(i)};(s=o[e]).beingProcessed||s.done?this.onFrameFinished():(s.sampleInterval=r,s.beingProcessed=!0,s.gifshot=!0,(c=this.getWorker())?(c.onmessage=l,c.postMessage(s)):l({data:t.workerMethods.run(s)}))},startRendering:function(e){this.onRenderCompleteCallback=e;for(var t=0;t<this.options.numWorkers&&t<this.frames.length;t++)this.processFrame(t)},processNextFrame:function(){for(var e=-1,t=0;t<this.frames.length;t++){var n=this.frames[t];if(!n.done&&!n.beingProcessed){e=t;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,t){var n=[],i={loop:this.repeat},r=this.options,o=r.interval,a=r.frameDuration,s=!!r.images.length,c=r.gifHeight,d=r.gifWidth,u=new E(n,d,c,i),f=this.onRenderProgressCallback,h=s?100*o:0,m=void 0;this.generatingGIF=!0,l.each(e,function(t,n){var i=n.palette;f(.75+.25*n.position*1/e.length);for(var r=0;r<a;r++)u.addFrame(0,0,d,c,n.pixels,{palette:i,delay:h})}),u.end(),f(1),this.frames=[],this.generatingGIF=!1,l.isFunction(t)&&(m=this.bufferToString(n),t("data:image/gif;base64,"+l.btoa(m)))},setRepeat:function(e){this.repeat=e},addFrame:function(e,t){t=l.isObject(t)?t:{};var n=this.ctx,i=this.options,r=i.gifWidth,o=i.gifHeight,a=l.getFontSize(t),s=t,c=s.filter,d=s.fontColor,u=s.fontFamily,f=s.fontWeight,h=(s.gifHeight,s.gifWidth,s.text),m=s.textAlign,p=s.textBaseline,g=t.textXCoordinate?t.textXCoordinate:"left"===m?1:"right"===m?r:r/2,v=t.textYCoordinate?t.textYCoordinate:"top"===p?1:"center"===p?o/2:o,b=f+" "+a+" "+u,E=void 0;try{n.filter=c,n.drawImage(e,0,0,r,o),h&&(n.font=b,n.fillStyle=d,n.textAlign=m,n.textBaseline=p,n.fillText(h,g,v)),E=n.getImageData(0,0,r,o),this.addFrameImageData(E)}catch(e){return""+e}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=this.frames,n=e.data;this.frames.push({data:n,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:t.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var t=this;t.startRendering(function(n){t.destroyWorkers(),l.requestTimeout(function(){e(n)},0)})},destroyWorkers:function(){if(!this.workerError){var e=this.workers;l.each(e,function(e,t){var n=t.worker,i=t.objectUrl;n.terminate(),l.URL.revokeObjectURL(i)})}}};var y=function(){},x={getGIF:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=arguments[1];t=l.isFunction(t)?t:y;var n=r.createElement("canvas"),i=void 0,o=!!e.images.length,s=e.cameraStream,c=e.crop,d=e.filter,u=e.fontColor,f=e.fontFamily,h=e.fontWeight,m=e.keepCameraOn,p=(e.numWorkers,e.progressCallback),g=e.saveRenderingContexts,v=e.savedRenderingContexts,b=e.text,E=e.textAlign,w=e.textBaseline,x=e.videoElement,F=e.videoHeight,k=e.videoWidth,S=e.webcamVideoElement,L=Number(e.gifWidth),T=Number(e.gifHeight),M=Number(e.interval),A=(Number(e.sampleInterval),o?0:1e3*M),B=[],D=v.length?v.length:e.numFrames,W=D,U=new C(e),O=l.getFontSize(e),R=e.textXCoordinate?e.textXCoordinate:"left"===E?1:"right"===E?L:L/2,j=e.textYCoordinate?e.textYCoordinate:"top"===w?1:"center"===w?T/2:T,P=h+" "+O+" "+f,H=c?Math.floor(c.scaledWidth/2):0,I=c?k-c.scaledWidth:0,q=c?Math.floor(c.scaledHeight/2):0,N=c?F-c.scaledHeight:0;D=D!==a?D:10,M=M!==a?M:.1,n.width=L,n.height=T,i=n.getContext("2d"),function e(){v.length||0!==x.currentTime?function e(){var n=W-1;function r(){var r;g&&B.push(i.getImageData(0,0,L,T)),b&&(i.font=P,i.fillStyle=u,i.textAlign=E,i.textBaseline=w,i.fillText(b,R,j)),r=i.getImageData(0,0,L,T),U.addFrameImageData(r),p((D-(W=n))/D),n>0&&l.requestTimeout(e,A),W||U.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e,cameraStream:s,videoElement:x,webcamVideoElement:S,savedRenderingContexts:B,keepCameraOn:m})})}v.length?(i.putImageData(v[D-W],0,0),r()):function e(){try{I>k&&(I=k),N>F&&(N=F),H<0&&(H=0),q<0&&(q=0),i.filter=d,i.drawImage(x,H,q,I,N,0,0,L,T),r()}catch(t){if("NS_ERROR_NOT_AVAILABLE"!==t.name)throw t;l.requestTimeout(e,100)}}()}():l.requestTimeout(e,100)}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.videoWidth,n=e.videoHeight,i=e.gifWidth,r=e.gifHeight,o={width:0,height:0,scaledWidth:0,scaledHeight:0};return t>n?(o.width=Math.round(t*(r/n))-i,o.scaledWidth=Math.round(o.width*(n/r))):(o.height=Math.round(n*(i/t))-r,o.scaledHeight=Math.round(o.height*(t/i))),o}},F={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function e(t){e.attempts=e.attempts||0;var n=t.cameraStream,i=t.completedCallback,r=t.videoElement;r&&(r.videoWidth>0&&r.videoHeight>0?(r.removeEventListener("loadeddata",F.findVideoSize),i({videoElement:r,cameraStream:n,videoWidth:r.videoWidth,videoHeight:r.videoHeight})):e.attempts<10?(e.attempts+=1,l.requestTimeout(function(){F.findVideoSize(t)},400)):i({videoElement:r,cameraStream:n,videoWidth:F.defaultVideoDimensions.width,videoHeight:F.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){l.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var t=l.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,n=e.cameraStream,i=e.completedCallback,r=e.streamedCallback,o=e.videoElement;if(l.isFunction(r)&&r(),t){if(l.isString(t))o.src=t,o.innerHTML='<source src="'+t+'" type="video/'+l.getExtension(t)+'" />';else if(t instanceof Blob){try{o.src=l.URL.createObjectURL(t)}catch(e){}o.innerHTML='<source src="'+t+'" type="'+t.type+'" />'}}else if(o.mozSrcObject)o.mozSrcObject=n;else if(l.URL)try{o.srcObject=n,o.src=l.URL.createObjectURL(n)}catch(e){o.srcObject=n}o.play(),l.requestTimeout(function e(){e.count=e.count||0,!0===F.loadedData?(F.findVideoSize({videoElement:o,cameraStream:n,completedCallback:i}),F.loadedData=!1):(e.count+=1)>10?F.findVideoSize({videoElement:o,cameraStream:n,completedCallback:i}):e()},0)},startStreaming:function(e){var t=l.isFunction(e.error)?e.error:l.noop,n=l.isFunction(e.streamed)?e.streamed:l.noop,i=l.isFunction(e.completed)?e.completed:l.noop,o=e.crossOrigin,a=e.existingVideo,s=e.lastCameraStream,c=e.options,d=e.webcamVideoElement,u=l.isElement(a)?a:d||r.createElement("video");o&&(u.crossOrigin=c.crossOrigin),u.autoplay=!0,u.loop=!0,u.muted=!0,u.addEventListener("loadeddata",function(e){F.loadedData=!0,c.offset&&(u.currentTime=c.offset)}),a?F.stream({videoElement:u,existingVideo:a,completedCallback:i}):s?F.stream({videoElement:u,cameraStream:s,streamedCallback:n,completedCallback:i}):l.getUserMedia({video:!0},function(e){F.stream({videoElement:u,cameraStream:e,streamedCallback:n,completedCallback:i})},t)},startVideoStreaming:function(e){var t=arguments.length>1&&arguments[1]!==a?arguments[1]:{},n=t.timeout!==a?t.timeout:0,i=t.callback,r=t.webcamVideoElement,o=void 0;n>0&&(o=l.requestTimeout(function(){F.onStreamingTimeout(i)},1e4)),F.startStreaming({error:function(){i({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(o)},completed:function(){var t=arguments.length>0&&arguments[0]!==a?arguments[0]:{},n=t.cameraStream,i=t.videoElement,r=t.videoHeight,o=t.videoWidth;e({cameraStream:n,videoElement:i,videoHeight:r,videoWidth:o})},lastCameraStream:t.lastCameraStream,webcamVideoElement:r,crossOrigin:t.crossOrigin,options:t})},stopVideoStreaming:function(e){var t=e=l.isObject(e)?e:{},n=t.keepCameraOn,i=t.videoElement,r=t.webcamVideoElement,o=e.cameraStream||{},a=o.getTracks&&o.getTracks()||[],s=!!a.length,c=a[0];!n&&s&&l.isFunction(c.stop)&&c.stop(),l.isElement(i)&&!r&&(i.pause(),l.isFunction(l.URL.revokeObjectURL)&&!l.webWorkerError&&i.src&&l.URL.revokeObjectURL(i.src),l.removeElement(i))}};function k(e){e=l.isObject(e)?e:{},F.stopVideoStreaming(e)}function S(e,t){var n=e.options||{},i=n.images,o=n.video,a=Number(n.gifWidth),s=Number(n.gifHeight),c=(Number(n.numFrames),e.cameraStream),d=e.videoElement,u=e.videoWidth,f=e.videoHeight,h=x.getCropDimensions({videoWidth:u,videoHeight:f,gifHeight:s,gifWidth:a}),m=t;n.crop=h,n.videoElement=d,n.videoWidth=u,n.videoHeight=f,n.cameraStream=c,l.isElement(d)&&(d.width=a+h.width,d.height=s+h.height,n.webcamVideoElement||(l.setCSSAttr(d,{position:"fixed",opacity:"0"}),r.body.appendChild(d)),d.play(),x.getGIF(n,function(e){i&&i.length||o&&o.length||k(e),m(e)}))}function L(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var n=l.mergeOptions(m,e)||{},i=e.cameraStream,o=n.images,s=o?o.length:0,c=n.video,d=n.webcamVideoElement;n=l.mergeOptions(n,{gifWidth:Math.floor(n.gifWidth),gifHeight:Math.floor(n.gifHeight)}),s?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,n=e.images,i=e.options,o=e.imagesLength,s=u.validate({getUserMedia:!0,"window.URL":!0}),c=[],d=0,f=void 0,h=void 0;if(s.error)return t(s);function m(){l.each(c,function(e,t){t&&(t.text?h.addFrame(t.img,i,t.text):h.addFrame(t,i))}),function(e,t){e.getBase64GIF(function(e){t({error:!1,errorCode:"",errorMsg:"",image:e})})}(h,t)}h=new C(i),l.each(n,function(e,n){var a=n;n.src&&(a=a.src),l.isElement(a)?(i.crossOrigin&&(a.crossOrigin=i.crossOrigin),c[e]=a,(d+=1)===o&&m()):l.isString(a)&&(f=new Image,i.crossOrigin&&(f.crossOrigin=i.crossOrigin),function(i){n.text&&(i.text=n.text),i.onerror=function(e){var n=void 0;if(0==--o)return(n={}).error="None of the requested images was capable of being retrieved",t(n)},i.onload=function(t){n.text?c[e]={img:i,text:i.text}:c[e]=i,(d+=1)===o&&m(),l.removeElement(i)},i.src=a}(f),l.setCSSAttr(f,{position:"fixed",opacity:"0"}),r.body.appendChild(f))})}({images:o,imagesLength:s,callback:t,options:n}):c?function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,n=e.existingVideo,i=e.options,r=u.validate({getUserMedia:!0,"window.URL":!0}),o=void 0,s=void 0;if(r.error)return t(r);if(l.isElement(n)&&n.src){if(s=n.src,o=l.getExtension(s),!l.isSupported.videoCodecs[o])return t(u.messages.videoCodecs)}else l.isArray(n)&&l.each(n,function(e,t){if(o=t instanceof Blob?t.type.substr(t.type.lastIndexOf("/")+1,t.length):t.substr(t.lastIndexOf(".")+1,t.length),l.isSupported.videoCodecs[o])return n=t,!1});F.startStreaming({completed:function(e){e.options=i||{},S(e,t)},existingVideo:n,crossOrigin:i.crossOrigin,options:i})}({existingVideo:c,callback:t,options:n}):function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{},t=e.callback,n=e.lastCameraStream,i=e.options,r=e.webcamVideoElement;if(!g())return t(u.validate());i.savedRenderingContexts.length?x.getGIF(i,function(e){t(e)}):F.startVideoStreaming(function(){var e=arguments.length>0&&arguments[0]!==a?arguments[0]:{};e.options=i||{},S(e,t)},{lastCameraStream:n,callback:t,webcamVideoElement:r,crossOrigin:i.crossOrigin})}({lastCameraStream:i,callback:t,webcamVideoElement:d,options:n})}}var T={utils:d,error:f,defaultOptions:p,createGIF:L,takeSnapShot:function(e,t){if(t=l.isFunction(e)?e:t,e=l.isObject(e)?e:{},l.isFunction(t)){var n=l.mergeOptions(m,e);L(l.mergeOptions(n,{interval:.1,numFrames:1,gifWidth:Math.floor(n.gifWidth),gifHeight:Math.floor(n.gifHeight)}),t)}},stopVideoStreaming:k,isSupported:function(){return u.isValid()},isWebCamGIFSupported:g,isExistingVideoGIFSupported:function(e){var t=!1;if(l.isArray(e)&&e.length){if(l.each(e,function(e,n){l.isSupported.videoCodecs[n]&&(t=!0)}),!t)return!1}else if(l.isString(e)&&e.length&&!l.isSupported.videoCodecs[e])return!1;return u.isValid({getUserMedia:!0})},isExistingImagesGIFSupported:function(){return u.isValid({getUserMedia:!0})},VERSION:"0.4.5"};(i=function(){return T}.apply(t,[]))===a||(e.exports=i)}("undefined"!=typeof window?window:{},"undefined"!=typeof document?document:{createElement:function(){}},"undefined"!=typeof window?window.navigator:{})},function(e,t){var n={HTTPrequest:function(e,t,n,i){return new Promise(function(r,o){var a=new XMLHttpRequest;if(a.open(t,e),n)for(var s in n)a.setRequestHeader(s,n[s]);a.onload=function(){r(a.response)},a.onerror=function(e){o(Error("Network Error "+e))},i?a.send(i):a.send()})}};e.exports=n},function(e,t,n){var i=n(1),r=n(0);e.exports=function(e,t,n,o,a){var s=[["#ffebee","#FCE4EC","#F3E5F5","#EDE7F6","#E8EAF6","#E3F2FD","#E1F5FE","#E0F7FA","#E0F2F1","#E8F5E9","#F1F8E9","#F9FBE7","#FFFDE7","#FFF8E1","#FFF3E0","#FBE9E7","#EFEBE9","white","#ECEFF1"],["#ffcdd2","#F8BBD0","#E1BEE7","#D1C4E9","#C5CAE9","#BBDEFB","#B3E5FC","#B2EBF2","#B2DFDB","#C8E6C9","#DCEDC8","#F0F4C3","#FFF9C4","#FFECB3","#FFE0B2","#FFCCBC","#D7CCC8","#F5F5F5","#CFD8DC"],["#ef9a9a","#F48FB1","#CE93D8","#B39DDB","#9FA8DA","#90CAF9","#81D4FA","#80DEEA","#80CBC4","#A5D6A7","#C5E1A5","#E6EE9C","#FFF59D","#FFE082","#FFCC80","#FFAB91","#BCAAA4","#EEEEEE","#B0BEC5"],["#e57373","#F06292","#BA68C8","#9575CD","#7986CB","#64B5F6","#4FC3F7","#4DD0E1","#4DB6AC","#81C784","#AED581","#DCE775","#FFF176","#FFD54F","#FFB74D","#FF8A65","#A1887F","#E0E0E0","#90A4AE"],["#ef5350","#EC407A","#AB47BC","#7E57C2","#5C6BC0","#42A5F5","#29B6F6","#26C6DA","#26A69A","#66BB6A","#9CCC65","#D4E157","#FFEE58","#FFCA28","#FFA726","#FF7043","#8D6E63","#BDBDBD","#78909C"],["#f44336","#E91E63","#9C27B0","#673AB7","#3F51B5","#2196F3","#03A9F4","#00BCD4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548","#9E9E9E","#607D8B"],["#e53935","#D81B60","#8E24AA","#5E35B1","#3949AB","#1E88E5","#039BE5","#00ACC1","#00897B","#43A047","#7CB342","#C0CA33","#FDD835","#FFB300","#FB8C00","#F4511E","#6D4C41","#757575","#546E7A"],["#d32f2f","#C2185B","#7B1FA2","#512DA8","#303F9F","#1976D2","#0288D1","#0097A7","#00796B","#388E3C","#689F38","#AFB42B","#FBC02D","#FFA000","#F57C00","#E64A19","#5D4037","#616161","#455A64"],["#c62828","#AD1457","#6A1B9A","#4527A0","#283593","#1565C0","#0277BD","#00838F","#00695C","#2E7D32","#558B2F","#9E9D24","#F9A825","#FF8F00","#EF6C00","#D84315","#4E342E","#424242","#37474F"],["#b71c1c","#880E4F","#4A148C","#311B92","#1A237E","#0D47A1","#01579B","#006064","#004D40","#1B5E20","#33691E","#827717","#F57F17","#FF6F00","#E65100","#BF360C","#3E2723","black",,"#263238"]],c=function(){var e,t=null,n=document.querySelector("#overlay"),i=function(){n.classList.add("hidden"),e&&e.classList.remove("active"),t&&(t.classList.add("hidden"),t=null)};return n.addEventListener("click",i),{initShowSubmenu:function(r,o,a){r.classList.add("hidden"),o.addEventListener("click",function(){t===r?i():(a&&a(),function(r,o){i(),(e=o).classList.add("active"),n.classList.remove("hidden"),(t=r).classList.remove("hidden")}(r,o))})},hideSubmenu:i}},l=function(e,t,n,i){var r;t.forEach(function(t){var o=document.createElement("div");e.appendChild(o),t.forEach(function(e){var t=document.createElement("div");t.style.backgroundColor=e,e===n&&(i(n),(r=t).classList.add("selected")),t.addEventListener("click",function(t){r.classList.remove("selected"),(r=t.target).classList.add("selected"),i(e)}),o.appendChild(t)})})},d=function(e,t,n,i){var r;t.forEach(function(t,o){var a=document.createElement("div"),s=document.createElement("img");s.src=t.icon,a.appendChild(s),t.width===n&&(i(t),(r=a).classList.add("active")),a.addEventListener("click",function(e){r&&r.classList.remove("active"),(r=a).classList.add("active"),i(t)}),e.appendChild(a)})},u=function(e,t,n,i,r){var o,a,s,c=document.createElement("div"),l=document.createElement("canvas"),d=document.createElement("table"),u=[.05,.25,.5,1,2],f=[6,3,2,1,.5].map(function(e){return u.map(function(t){return{lifetime:1e3*t,beat:1e3*e}})});return window.dt=s,c.appendChild(l),c.style.position="absolute",d.style.position="absolute",d.style.borderCollapse="collapse",d.style.height=r.height,d.style.width=r.width,(s=d.cloneNode()).style.backgroundColor="white",e.appendChild(s),e.appendChild(c),e.appendChild(d),a=i.makeTimingDemo(l,f,r),f.forEach(function(e,i){var r=document.createElement("tr");d.appendChild(r);var a=document.createElement("tr");s.appendChild(a),e.forEach(function(e,c){var l=document.createElement("td");l.classList.add("b"+i+"l"+c);var d=l.cloneNode();d.style.border="solid #dddddd 1px",e.lifetime===1e3*t.lifetime&&e.beat===1e3*t.beat&&(n({lifetime:e.lifetime/1e3,beat:e.beat/1e3}),(o=d).classList.add("active")),l.addEventListener("click",function(t){o&&o.classList.remove("active"),(o=function(e){return s.querySelector("tr>td."+e.className)}(l)).classList.add("active"),n({lifetime:e.lifetime/1e3,beat:e.beat/1e3})}),r.appendChild(l),a.appendChild(d)})}),a},f=function(e,t,n,i){var r;t.forEach(function(t,o){var a=document.createElement("div"),s=document.createElement("img");s.src=t.icon,a.classList.add("old"),a.appendChild(s),t.lifetime===n.lifetime&&t.beat===n.beat&&(i(t),(r=a).classList.add("active")),a.addEventListener("click",function(e){r&&r.classList.remove("active"),(r=a).classList.add("active"),i(t)}),e.appendChild(a)})},h=function(e,t){var n=document.querySelector("#pause-button"),i=document.querySelector("#rewind-button"),r=document.querySelector("#forward-button"),o=[n,i,r],a=["6_play.svg","6_pause.svg"],s=1,c=function(c){s=c,e(c);var l=s?1:0,d=function(e){return 0===e||1===e?null:e>1?r:i}(c);n.firstChild.src="icons/"+a[l],o.forEach(function(e){e===d?e.classList.add("active"):e.classList.remove("active")}),t.hideSubmenu()},l=function(e){var t,n=0===s;n=n||Math.sign(s)==Math.sign(e),t=Math.abs(s)<=.125?.125*e:n?s:-.5*s,c(s+t)};e(s),n.addEventListener("click",function(){c(s=s?0:1)}),i&&i.addEventListener("click",function(){l(-1)}),r&&r.addEventListener("click",function(){l(1)})};!function(e){var m=c();!function(e,t){var n=document.querySelector("#color-submenu"),i=document.querySelector("#color-button");t.initShowSubmenu(n,i),l(n,s,e.initial,function(n){i.style.fill=n,i.style.stroke=n,t.hideSubmenu(),e.handle(n)})}({initial:"#303F9F",handle:function(t){e.setLineColor(t)}},m),function(e,t){var n=document.querySelector("#stroke-button"),i=document.querySelector("#stroke-submenu"),r=[2,7,20,50,200,600].map(function(e,t){return{width:e,icon:"icons/2_taille_"+(t+1)+".svg"}});t.initShowSubmenu(i,n),d(i,r,e.initial,function(i){n.firstChild.src=i.icon,t.hideSubmenu(),e.handle(i.width)})}({initial:20,handle:function(t){e.setStrokeWidth(t)}},m);var p=function(e,t,n,i,r){var o=document.querySelector("#timing-button"),a=document.querySelector("#timing-submenu"),s=[[.05,.5],[.25,1],[.5,2],[1,2],[1,4],[2,1]].map(function(e,t){return{lifetime:e[0],beat:e[1],icon:"icons/3_trait_"+(t+1)+".svg"}}),c=function(n){n.icon&&(o.firstChild.src=n.icon),t.hideSubmenu(),e.handle(n)};if(t.initShowSubmenu(a,o),n){var l=u(a,e.initial,c,i,r);return function(e){"speed"in e&&l.setSpeed(e.speed)}}return f(a,s,e.initial,c),function(){}}({initial:{lifetime:.5,beat:2},makeTimingDemo:e.makeTimingDemo,handle:function(t){e.setLifetime(1e3*t.lifetime),e.setBeat(1e3*t.beat)}},m,o,e,a);!function(e,t){var n=document.querySelector("#clear-button"),i=document.querySelector("#undo-button"),r=document.querySelector("#redo-button");document.querySelector("#export-button"),n.addEventListener("click",function(){t.hideSubmenu(),e.clear()}),i.addEventListener("click",function(){t.hideSubmenu(),e.undo()}),r.addEventListener("click",function(){t.hideSubmenu(),e.redo()})}({clear:e.clear,undo:i.undo,redo:i.redo},m),h(function(t){e.setSpeed(t),p({speed:t})},m),n(m,e,r,t)}(e)}},function(e,t,n){n(9);var i=n(3),r=n(0),o=n(6),a=n(2),s=n(1);document.addEventListener("DOMContentLoaded",function(){try{e=i.getUrlParams(location.href),t={canvas:document.getElementById("main-canvas"),paper:paper},(n=a({graphics:t,backgroundColor:"#fffff"})).start(),e.gist&&r.gists.load(e.gist,n.importData),o.install({lineControl:{id:"line-control",colorSetter:function(e){n.setLineColor(e)},strokeWidthSetter:function(e){n.setStrokeWidth(e)},beatSetter:function(e){n.setBeat(1e3*e)},lifeTimeSetter:function(e){n.setLifetime(1e3*e)},timingSetter:function(e){console.log(e)},periodsSetter:function(e){n.setPeriods(e)}},looperControl:{id:"looper-control",clear:n.clear,undo:s.undo,redo:s.redo,setSpeed:n.setSpeed,setBeatListener:n.setBeatListener,tapTempo:n.tapTempo,importData:n.importData,exportData:n.exportData,record:n.record,findShortestLoop:n.findShortestLoop}})}catch(e){console.error(e)}var e,t,n})}]);